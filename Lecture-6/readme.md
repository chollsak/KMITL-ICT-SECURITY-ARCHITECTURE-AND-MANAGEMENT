***Lecture 6: DETECTION AND RESPONSE***

## การทบทวน

**กระบวนการโจมตีด้านความปลอดภัย:**
- การสำรวจข้อมูล (Reconnaissance)
- การโจมตี (Exploitation)
- การเสริมสร้าง (Reinforcement)
- การรวมตัว (Consolidation)
- การปล้นสะดม (Pillage)

**กระบวนการด้านความปลอดภัย:**
- การประเมิน (Assessment)
- การป้องกัน/ป้องปราม (Protection/Prevention)
- การตรวจจับ (Detection)
- การตอบสนอง (Response)

**เนื้อหาของวันนี้:**
- การตรวจจับและการตอบสนอง


## การตรวจจับและการป้องกันการบุกรุก
![alt text](/Lecture-6/img/classification.png)
**การจำแนกประเภทของหัวข้อ:**

1. **ระบบการตรวจจับและป้องกันการบุกรุก (Intrusion Detection and Prevention System, IDS/IPS)**
2. **การตรวจสอบบริการ, โฮสต์ และลักษณะของระบบ**
3. **การบันทึกและการตรวจสอบ (Logging and Audits)**
4. **การประเมินช่องโหว่ & การตอบสนองต่อเหตุการณ์ (Vulnerability Assessment & Incident Response)**

# ระบบการตรวจจับและป้องกันการบุกรุก (IDS/IPS)

## การตรวจจับการบุกรุกคืออะไร?

- **ความหมายหลากหลาย:**
  - การป้องกันการฉ้อโกงทางโทรศัพท์ใน PBXs
  - พื้นฐานทางคณิตศาสตร์ของการประมวลผลข้อมูลทางสถิติ
  - กฎไฟร์วอลล์และนโยบายการกรอง
  - วิธีการติดตามและตรวจสอบกิจกรรมที่น่าสงสัย
  - ผลิตภัณฑ์และอุปกรณ์ที่สร้างการแจ้งเตือนเกี่ยวกับกิจกรรมเครือข่ายที่น่าสงสัย

- **ลักษณะของสาขานี้:**
  - เป็นสาขาที่ค่อนข้างใหม่และกำลังพัฒนาอย่างต่อเนื่อง
  - ยากที่จะกำหนดความหมายที่แน่นอน

## ทำไมต้องการการตรวจจับการบุกรุก?

- **ความสำคัญ:**
  - คุณอาจไม่รู้ว่าระบบ/เครือข่ายของคุณถูกโจมตีจนกว่าจะสายเกินไป
  - อาจนำไปสู่การสูญเสียทรัพย์สินทางปัญญา, ความรับผิดชอบ, เป็นต้น
  - ช่วยให้คุณออกแบบความปลอดภัยที่ดีขึ้นสำหรับระบบของคุณและแก้ไขช่องโหว่และข้อบกพร่องอย่างรวดเร็ว

- **ความสามารถ:**
  - ตรวจจับการสำรวจข้อมูลและการโจมตีที่กำลังดำเนินอยู่
  - สร้างการแจ้งเตือนสำหรับเจ้าหน้าที่รักษาความปลอดภัยให้ดำเนินการ

## คำจำกัดความ

- **การตรวจจับการบุกรุก:**
  - กระบวนการในการระบุและตอบสนองต่อกิจกรรมที่เป็นอันตรายที่มุ่งเป้าไปที่ทรัพยากรคอมพิวเตอร์และเครือข่าย

- **กระบวนการ:**
  - รวมถึงผู้คน, เทคโนโลยี, และเครื่องมือ
  - ไม่สามารถทำงานได้โดยปราศจากการมีส่วนร่วมของมนุษย์

- **การระบุ:**
  - ลักษณะของเวลาที่เกิดเหตุ - ก่อน, ระหว่าง หรือหลังการโจมตี

- **การตอบสนอง:**
  - หลังจากการระบุเกิดขึ้น ต้องทำอะไร?
    - อนุญาตให้การโจมตีดำเนินต่อไปเพื่อที่ Oscar จะสามารถถูกติดตามได้, หรือหยุดการโจมตีเพื่อจำกัดความเสียหาย เป็นต้น

## สถาปัตยกรรมของระบบการตรวจจับการบุกรุก (IDS)
![alt text](/Lecture-6/img/IDS.png)
**การตรวจสอบ (Monitoring)**
- ระบบ IDS จะตรวจสอบและประมวลผลข้อมูล/ข้อมูล
- มีผลกระทบทางเทคนิคและการดำเนินงาน เช่น ความทันท่วงที, ความมั่นใจในข้อมูล, และพลังการประมวลผลที่ต้องการ

**การรายงาน (Reporting)**
- ข้อมูลที่ตรวจสอบต้องถูกส่งไปยังโครงสร้างพื้นฐานที่เหมาะสม

**การตอบสนอง (Responding)**
- การดำเนินการที่ IDS ใช้เพื่อลดความเสี่ยงด้านความปลอดภัย


## วิธีการตรวจจับการบุกรุก

**1. IDS ที่เน้นโฮสต์ (Host-based IDS)**
- **System Centric**
  - ใช้การประมวลผล Audit Trail, ตรวจสอบการล็อกอิน, จับการติดตั้งโค้ด Trojan
  - บางครั้งถูกติดตั้งบนโฮสต์เป้าหมาย

**2. IDS ที่เน้นเครือข่าย (Network-based IDS)**
- ใช้การประมวลผลแบบทันที
- วิเคราะห์แพ็กเก็ตที่ไหลเข้า/ออกจากเครือข่าย
  - บางครั้งอาจเป็นแค่เครื่องมือตรวจจับแบบพื้นฐาน
- เปรียบเทียบลายเซ็นของการโจมตีที่รู้จักกับแพ็กเก็ตที่ตรวจจับและออกการแจ้งเตือน

**3. IDS ที่เน้นพฤติกรรม (Behavior-based IDS)**
- เข้าใจรูปแบบการใช้งานปกติและผิดปกติและแจ้งปัญหาที่อาจเกิดขึ้น



## การประมวลผล Audit Trail

**แนวคิด**
- ใช้ระบบล็อกจากโฮสต์และอุปกรณ์ต่าง ๆ
- ดำเนินการแบบออฟไลน์และไม่มีการวิเคราะห์เรียลไทม์
- ล็อกจะถูกวิเคราะห์และข้อมูลจะถูกประมวลผล
- การจัดเก็บ, การประมวลผล และการปกป้องข้อมูล Audit เป็นสิ่งสำคัญ
  - อาจติดตั้งโปรบสำหรับการตรวจสอบบนระบบเป้าหมาย
  - ปัญหาที่อาจเกิดขึ้นคือการเสื่อมประสิทธิภาพของเป้าหมายจากโปรบตรวจสอบ


## การประมวลผลแบบทันที (On-the-fly Processing)

**แนวคิด**
- ดำเนินการวิเคราะห์ทั้งแบบเรียลไทม์และไม่เรียลไทม์
  - มักเกี่ยวข้องกับ IDS ที่เน้นเครือข่าย
- ตรวจสอบและวิเคราะห์แพ็กเก็ตทั้งหมด
- มองหาคำที่ไม่พึงประสงค์ เช่น /etc/passwd หรือ \winnt\system32\config
- ใช้ tcpdump และเครื่องมือตรวจจับอื่น ๆ ในโหมดพรอมิสคัสเพื่อจับแพ็กเก็ต
- ปัญหาคือความจุของบัฟเฟอร์อาจส่งผลต่อการจับและตรวจสอบแพ็กเก็ตทั้งหมด

## การใช้โปรไฟล์พฤติกรรมปกติ

**แนวคิด**
- เริ่มต้นด้วยการจับความคาดหวังเกี่ยวกับกิจกรรมของผู้ใช้และระบบ
- ประมาณโปรไฟล์กิจกรรมปกติเริ่มต้น
- ปรับปรุงโปรไฟล์ด้วยเวลา (การปรับแต่ง)
- ใช้แหล่งข้อมูลทั้งหมดสำหรับการสร้างโปรไฟล์
  - ไม่ใช่แค่ข้อมูลที่มีอยู่ทางอิเล็กทรอนิกส์
- **ตัวอย่าง:**
  - ผู้ใช้ที่ไม่เคยล็อกอินหลัง 18.00 น. ล็อกอินตอน 01.00 น.
  - แหล่งข้อมูลอื่นบอกว่าผู้ใช้นั้นกำลังเดินทางไปมาเลเซีย



## การใช้ลายเซ็นของพฤติกรรมที่ผิดปกติ

**วิธีที่พบบ่อยที่สุดในการตรวจจับการบุกรุก**

**แนวคิด**
- ลายเซ็นการโจมตีเป็นที่รู้จักเหมือนกับฐานข้อมูลไวรัส
  - **ตัวอย่าง:** การโจมตีแบบ Smurf (ลายเซ็นของการโจมตีคืออะไร?)
- วิเคราะห์แพ็กเก็ตเพื่อดูว่าตรงกับลายเซ็นการโจมตีหรือไม่เพื่อตรวจจับการบุกรุก

**ข้อคิดเห็น**
- สมมติว่ามีความรู้เกี่ยวกับประเภทของการโจมตีและอาจพลาดการโจมตีใหม่หรือรูปแบบของการโจมตี
- บางครั้งสตริงที่น่าสงสัยก็ถูกจับคู่ด้วย



## ตัวอย่างลายเซ็นที่ง่าย

**1. การโจมตีแบบ Land**
- เป็นการโจมตี DoS ที่ที่อยู่ IP ของแหล่งที่มาและปลายทางเหมือนกัน
- อาจถูกเปิดตัวจากภายในเครือข่ายของคุณ

**2. WinNuke**
- ตั้งค่าแฟลก URG ใน TCP และส่งแพ็กเก็ตไปยังพอร์ต 139 บนระบบ Windows ทำให้ระบบล้มเหลว

**3. Xmas Tree**
- ตั้งค่าแฟลกทั้งหมดใน TCP เป็น 1 (URG, PSH, RST, ACK, SYN, FIN)
- เป็นการโจมตี DoS
- IDS ควรจับได้อย่างรวดเร็วตามลายเซ็น


## การตรวจสอบ: TCPDUMP

**tcpdump** ช่วยให้คุณตรวจสอบแพ็กเก็ตบนลิงก์ในเครือข่าย
- ให้ข้อมูลตามแพ็กเก็ตที่ตรวจจับ
- ต้องการสิทธิ์ root เพื่อจับแพ็กเก็ตบนเครื่อง Linux/Unix/Mac OS X
- มีเทียบเท่า Windows ชื่อว่า **windump**

**แนวคิด**
- NIC ทำงานในโหมดพรอมิสคัสจับแพ็กเก็ตทั้งหมด ไม่ใช่แค่ที่มุ่งหมาย



## รายละเอียดของ TCPDUMP

- ผลลัพธ์จะเป็นหนึ่งบรรทัดสำหรับแต่ละเฟรมที่ตรวจจับ
- ประกอบด้วยฟิลด์ต่อไปนี้
  - **Timestamp:** ฟิลด์วินาทีเชื่อถือได้เพียงไม่กี่มิลลิวินาที
  - **IP:** แสดงที่อยู่แหล่งที่มาและปลายทางรวมทั้งหมายเลขพอร์ตของ TCP หรือ UDP
  - **อื่น ๆ:** แปลเฟรมอื่น ๆ เช่น arp, icmp เป็นต้น
  - ใช้ตัวกรองเพื่อรวบรวมข้อมูลอย่างเลือกสรร

**ตัวอย่างผลลัพธ์**
`17:26:11.679220 arp who-has 136.142.117.80 tell 136.142.117.1
17:30:08.024113 IP 136.142.117.1 > all-systems.mcast.net: igmp query v2`

![alt text](/Lecture-6/img/17.png)
![alt text](/Lecture-6/img/18.png)

## ข้อสังเกต

### การวิเคราะห์ผลลัพธ์ TCPDUMP

- การรู้จักการโจมตีบางประเภทที่ได้พูดถึงในชั้นเรียนและในหนังสือจะช่วยให้คุณสามารถระบุได้ว่าชุดแพ็กเก็ตใดอาจเป็นการโจมตีที่มีศักยภาพ
- **คำถามที่ควรถาม:**
  - ที่อยู่ IP แหล่งที่มาและปลายทางคืออะไร?
  - ใช้โปรโตคอลอะไร (ICMP, TCP, UDP, arp, ฯลฯ)?
  - พฤติกรรมที่เห็นเป็นพฤติกรรมปกติหรือไม่? (ตัวอย่าง - TCP แสดงการจับมือ 3 ทางที่ถูกต้อง, icmp echo reply แสดงการร้องขอ icmp echo ที่มาก่อน)
  - หากผิดปกติ, มันมีลักษณะคล้ายกับสถานการณ์การโจมตีใด ๆ หรือไม่?

## การระมัดระวังในการใช้ลายเซ็น

**ตัวอย่างของหนอน Nimda**
- ส่งคำขอ HTTP ที่ดูเหมือนเช่นนี้:
  - `GET /scripts/..%c0af../winnt/system32/cmd.exe?/c+dir`
  - สตริง `%c0af` = `/` ใน Unicode
  - คำขอนี้เดินทางผ่านไดเรกทอรีรากเพื่อหาประโยชน์จากข้อผิดพลาดใน IIS ของ Microsoft

- **ลายเซ็นควรมองหาอะไร?**
  - หากมันมองหาคำขอเฉพาะข้างต้น, อาจพลาดคำขอที่มีการเปลี่ยนแปลง
  - บาง IDS จะถอดรหัสคำขอและดูสิ่งที่มันกำลังขอ

## False Positives (การเตือนผิดพลาด)

- รายงานว่ามีการบุกรุกเมื่อไม่มีการบุกรุกจริง
- เกิดขึ้นกับ IDS ทั้งหมด
- ขึ้นอยู่กับลายเซ็นและความใกล้เคียงกับกิจกรรมปกติ
- เกิดขึ้นกับลายเซ็นทั่วไป:
  - **ตัวอย่าง:** คำขอใด ๆ ที่มี `cmd.exe` ที่ไหนก็ได้
    - อาจปฏิเสธ URL ที่มี `cmd.exe-analysis.html`
    - อาจปฏิเสธการเข้าถึง `nascmd.exe`
- การเตือนผิดพลาดมากเกินไปอาจทำให้ผู้ปฏิบัติงานปิดการใช้งานลายเซ็นบางอย่าง

## False Negatives (การเตือนที่พลาด)

- ลายเซ็นล้มเหลวในการสร้างการเตือนซึ่งควรจะถูกสร้าง
- เกิดขึ้นเมื่อลายเซ็นเฉพาะมากเกินไปและไม่ตรงกับการเปลี่ยนแปลง
- **ตัวอย่าง:**
  - Nimda
    - ตรวจสอบ `/winnt/system32/cmd.exe`
    - ไม่สามารถออกการเตือนสำหรับ `/winnt/system32/../system32/cmd.exe`
    - อาจอนุญาต `/winnt/system32/cmd.%65xe`
  - แพ็กเก็ตที่แบ่งเป็นส่วน (Fragmented packets) เป็นอีกตัวอย่างหนึ่ง

![alt text](/Lecture-6/img/vs.png)

## การจับคู่รูปแบบพารามิเตอร์

- เป็นวิธีที่ละเอียดอ่อนมากซึ่งใช้ความรู้และประสบการณ์ในการดำเนินงานในชีวิตประจำวันเพื่อตรวจจับความผิดปกติ
- กรณีพิเศษของวิธีการสร้างโปรไฟล์:
  - ไม่มีโปรไฟล์เฉพาะที่มีอยู่ แต่บางสิ่งดูเหมือนจะไม่ถูกต้อง
  - มักต้องมีการมีส่วนร่วมของมนุษย์เพิ่มเติมจากการจับคู่รูปแบบ
- การเปลี่ยนแปลงเล็กน้อยในพารามิเตอร์การดำเนินงานสามารถนำไปสู่การตรวจจับการโจมตีที่อาจเกิดขึ้น

## การจัดระเบียบ IDS

- **มุมมองทั่วไป:**
  - ผู้ขายมีสถาปัตยกรรมเฉพาะที่อาจแตกต่างกัน
  - บางส่วนประกอบอาจเรียกแตกต่างกันไป
  - โปรดทราบว่า IDS หลายตัวอาจมีปฏิสัมพันธ์ซึ่งกันและกันเพื่อให้ความเชื่อถือได้ในระดับที่สูงขึ้น

![alt text](/Lecture-6/img/idss.png)

## ขยายส่วนประกอบของ IDS - I

**เซ็นเซอร์ (Sensor)**
- อุปกรณ์ที่ให้ข้อมูลที่จำเป็นเกี่ยวกับระบบเป้าหมาย
- อาจเรียกว่า โปรบ (Probe), โมนิเตอร์ (Monitor), ฟีด (Feed), แท็ป (Tap), หรือกล่องเหตุการณ์ (Event Boxes) เป็นต้น

**การจัดการระบบ (System Management)**
- ชั้นที่ช่วยในการสื่อสารระหว่างเซ็นเซอร์และส่วนประกอบอื่น ๆ
- ใช้โปรโตคอลการจัดการเช่น SNMP หรือโปรโตคอลอื่น ๆ

**อัลกอริธึม (Algorithms)**
- เป็นส่วนหนึ่งของเครื่องมือประมวลผล
- เป็นส่วนที่ซับซ้อนที่สุดของ IDS ซึ่งรวมถึงการตัดสินใจ, การขุดข้อมูล, การจับคู่รูปแบบ เป็นต้น

**ฐานความรู้ (Knowledge Bases)**
- ประกอบด้วยโปรไฟล์ของผู้ใช้และระบบ, ลายเซ็นการโจมตี, ข้อมูลสำหรับการทำความสัมพันธ์ เป็นต้น
- มีหลายประเภทและรูปแบบ

**การเก็บบันทึก (Audit Archives)**
- เก็บบันทึกการตรวจสอบและข้อมูลที่เก็บถาวรอื่น ๆ
- ต้องพิจารณาอย่างรอบคอบว่าข้อมูลควรเก็บไว้นานแค่ไหนและการรีเฟรชบ่อยเพียงใด
- เครื่องมือบันทึกที่มีอยู่มักจะไม่เข้ากันกับ IDS

**สัญญาณเตือน (Alarms)**
- โดยทั่วไปจะเตือนบุคคล
- พัฒนาไปสู่การโต้ตอบกับเซ็นเซอร์ผ่านชั้นการจัดการระบบเพื่อจับผู้โจมตี, เบี่ยงเบนการจราจร, ปิดการเข้าถึง ฯลฯ

**ส่วนติดต่อผู้ใช้กราฟิก (Graphical User Interface, GUI)**
- สิ่งที่แสดงให้กับผู้ปฏิบัติงานอาจมีความสำคัญต่อการดำเนินการที่รวดเร็ว
- ส่วนใหญ่จะอิงจากการโจมตีที่รู้จักและข้อมูลที่สำคัญ

![alt text](/Lecture-6/img/idssmall.png)
## การติดตั้งเซ็นเซอร์

- **เซ็นเซอร์หลายตัว:**
  - ให้ความสำคัญกับความล้มเหลว
  - สามารถปรับแต่งให้รับชนิดของการจราจรที่ต้องการ
  - ช่วยในกรณีที่มีปริมาณการจราจรสูง
  - อาจติดตั้งทั้งสองด้านของไฟร์วอลล์เพื่อการครอบคลุมที่ดีขึ้น
  - ในเครือข่ายที่สลับกัน ต้องแน่ใจว่าเซ็นเซอร์สามารถมองเห็นการจราจรทั้งหมด
  - การติดตั้งเครือข่ายแยกต่างหากสำหรับการสื่อสารของเซ็นเซอร์อาจเป็นที่แนะนำเพื่อความปลอดภัยและประสิทธิภาพ

## ขยายส่วนประกอบของ IDS - II

**ฐานความรู้ (Knowledge Bases)**
- รวมถึงโปรไฟล์ของผู้ใช้, ระบบ, ลายเซ็นการโจมตี, และข้อมูลการทำความสัมพันธ์
- การทำงานในระหว่างการจัดมาตรฐานสำหรับการเข้ารหัสฐานความรู้

**การเก็บบันทึก (Audit Archives)**
- เก็บบันทึกการตรวจสอบและข้อมูลที่เก็บถาวร
- พิจารณาความยาวของการเก็บข้อมูลและความถี่ในการรีเฟรช
- มักจะไม่เข้ากันกับเครื่องมือบันทึกที่มีอยู่

![alt text](/Lecture-6/img/idssmall.png)

## ขยายส่วนประกอบของ IDS - III

**สัญญาณเตือน (Alarms)**
- โดยทั่วไปจะเตือนบุคคล, แต่สามารถพัฒนาไปสู่การโต้ตอบกับเซ็นเซอร์และดำเนินการเช่น การจับผู้โจมตี, เบี่ยงเบนการจราจร, และปิดการเข้าถึง

**ส่วนติดต่อผู้ใช้กราฟิก (Graphical User Interface, GUI)**
- แสดงข้อมูลที่สำคัญต่อผู้ปฏิบัติงาน
- อิงจากการโจมตีที่รู้จักและข้อมูลที่สำคัญ
- งานวิจัยที่มีจำกัดเกี่ยวกับการใช้ข้อมูลโดยผู้ปฏิบัติงานในสถานการณ์จริง

![alt text](/Lecture-6/img/idssmall.png)

## ข้อควรระวังเกี่ยวกับ IDS

- **ข้อจำกัดของ IDS เดี่ยว:**
  - IDS เดียวอาจไม่เพียงพอในการตรวจจับการโจมตีทั้งหมด
  - ใช้ IDS ที่อิงจากเครือข่ายร่วมกับ IDS ที่อิงจากโฮสต์และทำการเชื่อมโยงข้อมูล
  - ใช้ IDS ที่ซ้ำซ้อนเพื่อป้องกันการโจมตีหาก IDS หนึ่งล้มเหลว

- **ความอ่อนไหวต่อการโจมตี:**
  - IDS อาจถูกหลอกด้วยการอุโมงค์ข้อมูล, การแบ่งแพ็กเก็ต, และการโจมตีการแทรกและการหลบหลีก
  - อาจตกเป็นเป้าหมายของการโจมตี DoS

## การตรวจจับการโจมตี?

- **การโจมตีคืออะไร?**
  - การโจมตีคือชุดของการกระทำที่เกี่ยวข้องที่เกิดขึ้นโดยผู้โจมตี ซึ่งส่งผลให้เกิดภัยคุกคามด้านความปลอดภัยที่ไม่ได้รับอนุญาตต่อโดเมนเครือข่ายหรือการคอมพิวเตอร์

## การขยายความเกี่ยวกับการโจมตี

**ลำดับ (Sequence)**
- มีหลายกิจกรรมที่เรียงตามลำดับเวลา ซึ่งนำไปสู่การโจมตี
- สำคัญในการตรวจจับรูปแบบลำดับโดยเร็วที่สุด

**การกระทำที่เกี่ยวข้อง (Related Actions)**
- รวมถึงการกระทำที่ดูเหมือนไม่เกี่ยวข้องที่ผู้โจมตีทำเพื่อหลีกเลี่ยงการตรวจจับ
- การหลบเลี่ยงการตรวจจับอาจทำให้มีการให้เวลาผ่านไประหว่างการกระทำ

**การเกิดขึ้น (Occurrence)**
- การโจมตีเกิดขึ้นเมื่อมันเกิดขึ้นจริง
- การวางแผนการโจมตีไม่ถือว่าเป็นการโจมตี
- ต้องตรวจจับความพยายามในการโจมตี แม้จะไม่ประสบความสำเร็จ

## โมเดลเวลาในการโจมตี
![alt text](/Lecture-6/img/tempModel.png)

**โมเดลการโจมตีเป็นลำดับของการกระทำ**
- การกระทำบางอย่างอาจเป็นการตอบสนองจากระบบ/เครือข่ายเป้าหมาย
- ลำดับของการกระทำกลายเป็น "ลายเซ็นการโจมตี"
- ต้องแยกแยะเหตุการณ์/การกระทำที่เกี่ยวข้องกับการโจมตีและไม่เกี่ยวข้องกับการโจมตีตามเวลา

**ลำดับการกระทำ:**
- **การกระทำเริ่มต้น** โดย Oscar
- **การกระถุกต่อ** โดย Oscar
- **การกระทำถัดไป** โดย Oscar
- ...

**เวลาแปรผันระหว่างการกระทำ**
- **ผลกระทบด้านความปลอดภัยครั้งแรก**
- **การกระทำตามมา** โดย Oscar

## การทำความสัมพันธ์ข้อมูล (Information Correlation)

**ความสำคัญของการทำความสัมพันธ์ข้อมูล**
- การทำความสัมพันธ์ข้อมูลช่วยในการตรวจจับการโจมตีโดยการตีความ, รวม และวิเคราะห์ข้อมูลจากแหล่งที่มาทั้งหมด
- สามประเภทของการทำความสัมพันธ์:
  - **การทำความสัมพันธ์ของเซสชันเดียวกับหลายเซสชัน** 
  - **การทำความสัมพันธ์แบบเรียลไทม์กับหลังจากเกิดเหตุการณ์**
  - **การทำความสัมพันธ์แบบในแบนด์กับทั้งหมด**

**การทำความสัมพันธ์ของเซสชันเดียวกับหลายเซสชัน**
- **เซสชันเดียว**:
  - เกี่ยวข้องกับเซสชัน TCP หนึ่งเซสชัน
  - เริ่มต้นด้วยการจับมือ 3 ทางและสิ้นสุดด้วยสอง FINs
  - วิเคราะห์ว่าแพ็กเก็ตที่ส่งในเซสชันนั้นเกี่ยวข้องกันหรือไม่
  - ดูที่ชุดการตอบสนองและการกระทำของไคลเอนต์และเซิร์ฟเวอร์
- **หลายเซสชัน**:
  - แหล่งที่มาและปลายทางอาจแตกต่างกันหรืออาจเหมือนกัน
  - อาจมีการปลอมแปลงที่มาของข้อมูล
  - การซิงค์เวลาอาจยาก

**การทำความสัมพันธ์แบบเรียลไทม์กับหลังจากเกิดเหตุการณ์**
- **การทำความสัมพันธ์แบบเรียลไทม์**:
  - ไม่สามารถมองไปข้างหน้าได้
- **การวิเคราะห์หลังจากเกิดเหตุการณ์**:
  - อาจสามารถคาดเดาสิ่งที่อาจเกิดขึ้นและมองหามัน
  - ใช้การติดตามตรวจสอบซึ่งต้องทำหลังจากเกิดเหตุการณ์

**การทำความสัมพันธ์แบบในแบนด์กับทั้งหมด**
- **ในแบนด์**:
  - เกี่ยวข้องกับกิจกรรมการคอมพิวเตอร์และเครือข่ายที่เกี่ยวข้องกับระบบเป้าหมาย
  - รวมถึงข้อมูลหัวเรื่อง, ข้อมูลโปรโตคอล, ข้อมูลเพย์โหลด, เวลาเครือข่าย เป็นต้น
- **ทั้งหมด**:
  - ข้อมูลเพิ่มเติมเกี่ยวกับผู้ใช้หรือกิจกรรมที่อาจเป็นอะไรได้ (เช่น, มีคนเข้าไปในอาคาร)
  - ข้อมูลที่เกี่ยวข้องในแบนด์อาจถูกปลอมแปลงได้

## การทำความสัมพันธ์ของเซสชันเดียวกับหลายเซสชัน

**เซสชันเดียว**
- มักเกี่ยวข้องกับเซสชัน TCP หนึ่งเซสชัน
- เริ่มต้นด้วยการจับมือ 3 ทางและสิ้นสุดด้วยสอง FINs
- วิเคราะห์ว่าแพ็กเก็ตที่ส่งในเซสชันนั้นเกี่ยวข้องกันหรือไม่ และสถานะต่าง ๆ ถูกเปลี่ยนแปลงอย่างถูกต้องหรือไม่
- ดูที่ชุดการตอบสนองและการกระทำของไคลเอนต์และเซิร์ฟเวอร์
- ยากขึ้นเมื่อใช้โปรโตคอลที่ไม่มีเซสชัน เช่น UDP

**หลายเซสชัน**
- แหล่งที่มาและปลายทางอาจแตกต่างกันหรือเหมือนกัน
  - อาจเป็นแหล่งที่มาเดียวกัน แต่รายงานว่าเป็นแหล่งที่มาแตกต่าง (การปลอมแปลง)
- นาฬิกาอาจแตกต่างกันและทำให้ยากต่อการซิงค์การกระทำ, การตอบสนอง และเหตุการณ์
- ยากกว่าการทำความสัมพันธ์แพ็กเก็ตในเซสชันเดียว

## การทำความสัมพันธ์แบบเรียลไทม์กับหลังจากเกิดเหตุการณ์

**ปัจจัย**
- พลังการประมวลผล, การเข้าถึงข้อมูล, ความสามารถของมนุษย์ในการตอบสนองในเรียลไทม์ เป็นต้น

**การทำความสัมพันธ์แบบเรียลไทม์**
- ไม่สามารถมองไปข้างหน้าได้

**การวิเคราะห์หลังจากเกิดเหตุการณ์**
- อาจสามารถคาดเดาสิ่งที่อาจเกิดขึ้นและค้นหามัน
- หากใช้การติดตามตรวจสอบ ต้องทำหลังจากเกิดเหตุการณ์เนื่องจากการประมวลผลจะเป็นแบบชุด
- บางครั้งเหตุการณ์อาจยังเกิดขึ้นอยู่ขณะข้อมูลการโจมตีถูกประมวลผล

## การทำความสัมพันธ์แบบในแบนด์กับทั้งหมด

**ในแบนด์** = กิจกรรมการคอมพิวเตอร์และเครือข่ายที่เกี่ยวข้องกับระบบเป้าหมาย
- รวมถึงข้อมูลหัวเรื่อง, ข้อมูลโปรโตคอล, ข้อมูลเพย์โหลด, เวลาเครือข่าย เป็นต้น

**ทั้งหมด** = ข้อมูลเพิ่มเติมเกี่ยวกับผู้ใช้หรือกิจกรรม
- อาจเป็นอะไรได้แทบทุกอย่าง (เช่น, มีคนเข้าไปในอาคาร)

**ข้อควรระวัง**
- องค์ประกอบในแบนด์อาจถูกปลอมแปลง
  - เช่น บันทึกอาจถูกเขียนทับ
- ระดับความเชื่อมั่นของข้อมูลอาจแตกต่างกันตามประเภทของข้อมูล


## การตอบสนองต่อการโจมตีจาก IDS

**การตอบสนองแบบพาสซีฟ**
- ติดตามการจราจรจาก Oscar อย่างใกล้ชิดมากขึ้น

**ตัวอย่างการตอบสนองเชิงรุก**
- ส่งแพ็กเก็ต RST ที่ออกแบบมาเพื่อยุติการเชื่อมต่อ TCP
- ตั้งกฎใหม่ในไฟร์วอลล์หรือเปลี่ยนการควบคุมการเข้าถึง
- ต้องระมัดระวังเนื่องจากอาจเป็นการเตือนเท็จและอาจปฏิเสธการเชื่อมต่อที่ถูกต้อง

## แนวโน้มใน IDS - I

**IDS แบบกระจาย**
- แนวคิด:
  - ผู้ปฏิบัติงานจากทั่วโลกส่งบันทึกจากเซ็นเซอร์, ไฟร์วอลล์ ฯลฯ ไปยังบริการ IDS แบบกระจาย
  - เว็บไซต์ IDS แบบกระจายทำการทำความสัมพันธ์เพื่อระบุการโจมตี
  - ตัวอย่าง:
    - Attack Registry and Intelligence Service (ARIS) ที่ [http://aris.securityfocus.com](http://aris.securityfocus.com)
    - Dshield ที่ [http://www.dshield.org](http://www.dshield.org)

**IDS แบบเอาท์ซอร์ส (Outsourced IDS)**
- ให้บริษัทการจัดการ IDS ภายนอกทำการ IDS ให้คุณ
- ผลกระทบด้านความปลอดภัยและการขาดความรู้เกี่ยวกับสภาพแวดล้อมภายในอาจส่งผลต่อผลลัพธ์

## แนวโน้มใน IDS - II

**กลุ่มทำงานด้านการตรวจจับการบุกรุกของ IETF**
- ดูที่การทำงานร่วมกันของ IDS แบบกระจาย
- ต้องการข้อมูลรูปแบบและขั้นตอนการแลกเปลี่ยน
- การแบ่งปันข้อมูลระหว่างระบบการตรวจจับและตอบสนองต่อการบุกรุก
- กำลังพิจารณาความต้องการสำหรับการสื่อสารตามสถานการณ์
- ข้อกำหนดทั่วไปสำหรับรูปแบบข้อมูล:
  - Intrusion Detection Message Exchange Format - IDMEF
  - Intrusion Detection Exchange Protocol - IDXP

## เครื่องมือ IDS

**ผู้จำหน่าย IDS**
- ตัวอย่าง:
  - Enterasys Dragon - ระบบ UNIX ที่ปรับแต่งได้สูง
  - Cisco Secure - ขายอุปกรณ์ IDS
  - อื่น ๆ: ISS Blackice, ISS RealSecure, Symantec NetProwler
- IDS แบบโอเพ่นซอร์ส:
  - Snort: [http://www.snort.org](http://www.snort.org)
  - Analysis console for intrusion databases (ACID) ที่ [http://www.cert.org/kb/acid](http://www.cert.org/kb/acid)
  - SNARE และ SHADOW

## สิ่งที่ต้องพิจารณาใน IDS

- **ความลึกของการครอบคลุม (Depth of Coverage)**
  - IDS สามารถตรวจจับการโจมตีประเภทไหนได้บ้าง
  - คุณสมบัติการปรับแต่งที่มีอยู่
  - ระบบปฏิบัติการที่รองรับ

- **ความแม่นยำของการครอบคลุม (Accuracy of Coverage)**
  - จำนวนข้อผิดพลาดเชิงบวกและข้อผิดพลาดเชิงลบที่เกิดขึ้น

- **ความแข็งแกร่ง (Robustness)**
- **ความสามารถในการขยาย (Scalability)**
  - สามารถจัดการกับปริมาณการจราจรหนักได้หรือไม่
  - สามารถแสดงข้อมูลได้หรือไม่หากมีปริมาณข้อมูลมากเกินไป

- **กรอบการจัดการ (Management Framework)**
  - ความง่ายในการจัดการ IDS และดึงข้อมูลจากมัน
  - ความซับซ้อน, การอัปเดต

## ระบบป้องกันการโจมตี - IPSs

**ไฟร์วอลล์และ IDS แบบไฮบริดที่มีให้ในปัจจุบัน**
- ตัวอย่าง: Hogwash ([http://hogwash.sourceforge.net/oldindex.html](http://hogwash.sourceforge.net/oldindex.html))

**แนวโน้มล่าสุดคือ IPSs**
- รวมความสามารถในการบล็อกของไฟร์วอลล์กับการตรวจสอบแพ็กเก็ตเชิงลึก
- ดูบทความที่ [http://www.securityfocus.com/infocus/1670](http://www.securityfocus.com/infocus/1670)
- ต้องใช้โปรเซสเซอร์ที่ทรงพลังเพื่อทำงานอย่างถูกต้อง

## ข้อมูลเพิ่มเติมเกี่ยวกับ IPSs

**IPSs แบ่งออกเป็นสองประเภท:**
- **ผลิตภัณฑ์ IPS แบบอัตรา (Rate-Based IPS):** บล็อกการจราจรตามโหลด
- **ผลิตภัณฑ์ IPS แบบเนื้อหา (Content-Based IPS):** ใช้ลายเซ็นในการบล็อกการจราจร (เช่น Nimda)

**ตัวอย่างผลิตภัณฑ์และผู้จำหน่าย:**
- **แบบอัตรา:** TopLayer’s Attack Mitigator IPS
- **แบบเนื้อหา:** Checkpoint InterSpect

<br>

# Network Monitoring
**PROCEDURES AND TOOLS**

## การติดตามเครือข่าย

**การติดตามเครือข่าย** ให้ข้อมูล "การรับรู้" ของผู้ดูแลระบบเกี่ยวกับสถานะของสภาพแวดล้อมที่ได้รับการป้องกัน
- เป็นการติดตามที่ใช้งานจริง ไม่ใช่แค่การดมกลิ่นแบบพาสซีฟ
- ตรวจจับการหยุดชะงักในความพร้อมใช้งานของบริการ
  - ดิสก์ของโฮสต์อาจเต็ม (ทำไม?)
  - การโจมตี DoS
  - เซิร์ฟเวอร์ล่ม
- ตรวจจับการเปลี่ยนแปลงในประสิทธิภาพ
- ตรวจจับการเปลี่ยนแปลงในสภาพแวดล้อมที่อาจมีผลกระทบต่อความปลอดภัย
  - การเชื่อมต่อไร้สายที่เป็นอันตรายใหม่
  - การเปลี่ยนแปลงที่รีบร้อนในชุดกฎของไฟร์วอลล์

## ข้อคิดเห็น

- การติดตามนั้นเรียบง่าย - ไม่มองหากิจกรรมที่เป็นอันตราย - เพียงแค่ความผิดปกติที่เป็นไปได้
  - ทับซ้อนกับการจัดการเครือข่าย
- หากกระบวนการติดตามมีการกำหนดไว้อย่างชัดเจน
  - ปัญหาอาจถูกตรวจจับก่อนที่มันจะกลายเป็นเรื่องวิกฤต
- การติดตามมักจะเป็นศูนย์กลาง
  - ง่ายต่อการสัมพันธ์ข้อมูล
  - ใช้กลุ่มของเซิร์ฟเวอร์ที่รวมกันซึ่งลูกค้าตอบสนอง
  - ช่วยให้ตอบสนองได้อย่างรวดเร็ว
- การติดตามควรตามมาด้วยการบันทึก
  - สิ่งที่หลุดพ้นจากความสนใจทันทีสามารถตรวจสอบในอนาคตหากมีปัญหา

## ขั้นตอนการติดตาม

- กำหนดเป้าหมายและลำดับความสำคัญ
  - ต้องติดตามอะไรบ้าง?
    - โฮสต์และอุปกรณ์
      - ควรติดตามโฮสต์ทั้งหมด? โฮสต์บางตัวเท่านั้น? ตลอดเวลา? ...
    - บริการเครือข่าย
      - บริการทั่วไปคือ SMTP, POP, FTP, Telnet, SSH, IMAP
      - บางครั้งอาจติดตาม URL บางรายการ
      - ควรระวังบริการที่ทำงานอยู่ซึ่งไม่ควรทำงาน
    - คุณลักษณะในท้องถิ่นเช่น การใช้ CPU
  - ความถี่และประเภทของการแจ้งเตือนที่ต้องออก
  - การวิเคราะห์ความเสี่ยงมีความสำคัญที่นี่
    - ทรัพยากรมีความสำคัญแค่ไหน?
    - ความน่าจะเป็นที่มันจะถูกรบกวนคืออะไร?
  - ควรกำหนดเกณฑ์สำหรับการแจ้งเตือนอย่างไร?
    - การพิจารณาทางเศรษฐกิจ

## เครื่องมือในการติดตาม

- เพื่อการติดตามสถานะของเครือข่ายหรือระบบ จำเป็นต้องมีเครื่องมือ
  - เครื่องมือสามารถติดต่อโฮสต์และอุปกรณ์เพื่อตรวจสอบสถานะ
  - มักจะมีไคลเอนต์บนโฮสต์และอุปกรณ์ที่ตรวจสอบสถานะในท้องถิ่นและรายงานไปยังเซิร์ฟเวอร์เมื่อมีการสอบถาม
- เครื่องมือทำงานอย่างไร?
  - มีความสามารถในการเริ่มการเชื่อมต่อกับบริการด้วยตนเอง
  - ใช้แอพพลิเคชันเพื่อเชื่อมต่อกับบริการและติดตามพฤติกรรมของแอพพลิเคชัน
  - ใช้ SNMP หรือ APIs ที่เฉพาะเจาะจงสำหรับ OS (http://www.sitescope.com)

## ข้อพิจารณาด้านความปลอดภัย

- ความไวของข้อมูลที่ติดตาม
  - Oscar อาจนำข้อมูลนี้ไปใช้ในทางที่ไม่เหมาะสมได้หรือไม่?
- การตรวจสอบเอนทิตีที่เข้าถึง
  - ตรวจสอบให้แน่ใจว่าเฉพาะคำขอที่ได้รับอนุญาตเท่านั้นที่สามารถเข้าถึงข้อมูลได้
  - หลีกเลี่ยงการใช้การตรวจสอบตามที่อยู่!
- การเขียนข้อมูล
  - เครื่องมือการติดตามส่วนใหญ่ "อ่าน" ข้อมูลเท่านั้น แต่กลไกที่ใช้พื้นฐานอาจสามารถ "เขียน" ได้เช่นกัน
  - ต้องระวังในการปิดคุณสมบัตินี้
- ช่องโหว่ในเครื่องมือการติดตาม
  - เครื่องมือการติดตามอาจมีข้อบกพร่องและช่องทางลับ
  - รันเครื่องมือการติดตามในฐานะผู้ใช้ปกติ - ไม่ใช่ในฐานะ root
  - ปัจจุบัน เครื่องมือใช้ SNMPv3

## เครื่องมือการติดตามเครือข่าย - I

**Big Brother**
- ฟรีสำหรับการใช้งานเชิงพาณิชย์และทำงานได้ทั้งบน Unix และ Windows
- ติดตามเพียงอย่างเดียว ไม่จัดการโฮสต์หรืออุปกรณ์
- ขยายได้ด้วยสคริปต์และปลั๊กอินที่กำหนดเอง
- ต้องการตัวแทนไคลเอนต์ในโฮสต์ที่ติดตาม
- มีสี่ส่วนประกอบหลัก - probe, display, alert pager และ client

[ข้อมูลเพิ่มเติมเกี่ยวกับ Big Brother](http://www.quest.com/bigbrother/)
[เดโม Big Brother](http://demo.bb4.com/bb/)

## เครื่องมือการติดตามเครือข่าย - II

**HP Openview**
- เครื่องมือซอฟต์แวร์เชิงพาณิชย์ระดับสูง
- สามารถเรียนรู้ความสัมพันธ์ระหว่างบริการ
  - หากเราเตอร์ล้มเหลว HP Openview สามารถทำเครื่องหมายบริการอื่น ๆ เช่นอีเมลว่าไม่สามารถใช้งานได้

**เครื่องมืออื่น ๆ**
- BMC Patrol
- NetSaint (Nagios)
  - โอเพนซอร์ส

<br>

# Logging and Auditing
**TROUBLESHOOTING NETWORK PROBLEMS**

## ทำไมต้องวิเคราะห์ไฟล์ล็อก?

**การวิเคราะห์ไฟล์ล็อก** ช่วยในการระบุการบุกรุกและความพยายามในการบุกรุก
- แม้แต่ระบบตรวจจับการบุกรุกที่ดีที่สุดก็อาจไม่สามารถจับการบุกรุกทั้งหมดได้
  - การแทรกแซงของมนุษย์เป็นสิ่งสำคัญ
- บางครั้ง การบุกรุกอาจไม่ถูกตรวจพบหากไม่ได้ทำให้เกิดความเสียหายที่สามารถระบุได้
- ไฟล์ล็อกช่วยใน
  - การสัมพันธ์เหตุการณ์
  - การเข้าใจขั้นตอนของการบุกรุก

## ประโยชน์ของการวิเคราะห์ล็อก

- **ติดตามขั้นตอนของผู้บุกรุก**
  - เพื่อตรวจสอบว่าอุปกรณ์ใดอาจได้รับการบุกรุก
  - วิธีการโจมตีที่อาจถูกใช้
  - การสัมพันธ์เหตุการณ์
- **การดำเนินการด้านการบริหาร**
  - การดำเนินการทางวินัยกับผู้ที่อยู่ภายในองค์กร
  - การดำเนินการทางกฎหมายกับผู้โจมตีจากภายนอก
- **การจัดการเหตุการณ์**
  - ตรวจจับความผิดปกติของเครือข่าย
  - แก้ไขปัญหาเกี่ยวกับความพร้อมใช้งานของบริการ

## พื้นฐานของล็อก

- **มีหลายประเภทของไฟล์ล็อก**
  - ระบบปฏิบัติการส่วนใหญ่สร้างไฟล์ล็อกที่ครอบคลุม
  - เราเตอร์, ไฟร์วอลล์, IDSs สร้างไฟล์ล็อก
  - แอปพลิเคชันสร้างไฟล์ล็อกสำหรับเหตุการณ์สำคัญเช่น การตรวจสอบสิทธิ์
- **ไฟล์ล็อกมักจะมีรูปแบบของตนเอง**
  - อาจมีขนาดใหญ่และท่วมท้น
  - มักมีข้อมูลเช่น
    - เวลา, ข้อมูล IP (ที่อยู่, โปรโตคอล), พอร์ต TCP/UDP, ประเภท ICMP
  - บางไฟล์ยังมีข้อมูลเชิงพรรณนา, หมายเลขกฎที่ตรงกับการจราจร, การกระทำที่ดำเนินการ (อนุญาต, ปฏิเสธ ฯลฯ)
  - อาจมีข้อมูลอื่น ๆ เช่น TTL, ธง TCP, อินเทอร์เฟซที่เก็บแพ็กเก็ต, เนื้อหาบางส่วนของแพ็กเก็ต (หายาก)

## แสดงไฟล์ใน `/var/log`

**Syslog**
- **Syslog** = ระบบล็อก
  - ใช้ในหลายระบบปฏิบัติการและเราเตอร์เช่นกัน
  - Syslog ของ UNIX สามารถส่งไปยังเครื่องระยะไกลโดยใช้บริการ syslog ที่เป็นพื้นฐาน
    - มีช่องโหว่บางประการ (ใช้ UDP, ต้องการการตรวจสอบสิทธิ์ ฯลฯ)
    - ดู RFC 3164
  - มีอยู่บน Windows ในปัจจุบันด้วย
- **Syslog** เก็บล็อกใน `/var/log/` บนระบบที่คล้าย UNIX
  - Oscar จะพยายามเขียนทับล็อก!
  - มีเครื่องมือในการทำความสะอาดล็อกหลังจาก Oscar ใช้ระบบ (เช่น เปลี่ยนรหัสผ่านหรือสร้างบัญชีใหม่)
  - การเก็บล็อกในอุปกรณ์ที่ "เขียนครั้งเดียว" และอาจเพิ่มความซ้ำซ้อนในการบันทึกเป็นสิ่งสำคัญ

## ขั้นตอนการวิเคราะห์ล็อก

- การดูไฟล์ล็อกอาจเป็นเรื่องยุ่งยากและน่าเบื่อ
  - ควรกำหนดเวลาที่จะทำและยึดตามตารางเวลา
  - กำหนดเวลาที่จะดูล็อก
  - ทำความเข้าใจเกี่ยวกับความลึกของการวิเคราะห์
- การตรวจสอบไฟล์ล็อกเป็นประจำช่วยให้ผู้วิเคราะห์เข้าใจสิ่งที่เป็น "ปกติ" ในเครือข่าย
  - หลังจากนั้น รายการส่วนใหญ่จะไม่น่าสนใจ
  - การทำให้การวิเคราะห์ล็อกเป็นอัตโนมัติจะง่ายขึ้น
- บางไฟล์ล็อกอาจอยู่ในรูปแบบไบนารีที่เป็นกรรมสิทธิ์ซึ่งทำให้ยากต่อการวิเคราะห์หรือทำให้อัตโนมัติ
- ขนาดของล็อกอาจใหญ่จริง ๆ (หลายล้านรายการ)
  - อาจจำเป็นต้องลดขนาด
- **ล็อกดิบ** ไม่ควรถูกทิ้งเนื่องจากอาจให้ข้อมูลที่มีค่าและใช้สำหรับวัตถุประสงค์ทางกฎหมาย

## การดึงข้อมูลจากล็อก

- **เทคนิคการดึงข้อมูลที่เกี่ยวข้อง**
  - ใช้ยูทิลิตี้ค้นหา/หาตำแหน่ง
    - ประสิทธิภาพเป็นปัญหาสำคัญพิจารณาจากขนาดของล็อก, ความซับซ้อนของการค้นหา ฯลฯ
  - ส่งออกไปยังฐานข้อมูล
    - ความสะดวกในการจัดเก็บและการสร้างสถิติ
    - การสัมพันธ์ระยะยาวเป็นไปได้
  - การสร้างรายงาน
    - สรุปการโจมตีทั่วไปที่บ่อยครั้งและจำนวนมาก (เช่น การสแกนพอร์ต)
    - มุ่งเน้นที่รายละเอียดของการโจมตีที่ไม่บ่อยและอาจเกิดขึ้น
    - ให้ความสัมพันธ์ของเหตุการณ์ (ตัวอย่าง - กิจกรรมของที่อยู่ IP ที่น่าสงสัย)

## ข้อสังเกตเกี่ยวกับล็อก

- **เครื่องมือของบุคคลที่สาม** สำหรับการวิเคราะห์ล็อกสามารถใช้ได้
  - ตัวอย่าง: NetForensics และ Intellitactics
- **เวลาสำคัญ!**
  - คุณจะพิสูจน์ได้อย่างไรว่าข้อมูลที่รายงานเชื่อถือได้?
  - รายงานล็อกจากแหล่งที่มาที่แตกต่างกันได้รับการซิงโครไนซ์หรือไม่?
  - ใช้ NTP เพื่อวัตถุประสงค์นี้หรือไม่?

<br>

# Vulnerability Assessment and Incidence Response
## การประเมิน (Assessment)

**การประเมินความปลอดภัย** ของเครือข่าย/ระบบเป็นสิ่งสำคัญ
- **ขั้นตอนต่าง ๆ ที่เกี่ยวข้อง** 
  - การวางแผน, การสืบสวนเบื้องต้น, การระบุระบบ, การระบุบริการ, การค้นพบช่องโหว่, การวิจัยช่องโหว่
- **การประเมินจากภายนอก**
  - ใช้ผู้ตรวจสอบภายนอก
- **การประเมินภายใน**
  - ตรวจสอบการควบคุมการเข้าถึง, ตรวจสอบการรั่วไหลของข้อมูล, ตรวจสอบการจัดการไฟร์วอลล์

## การประเมินช่องโหว่ (Vulnerability Assessment)

- **ขั้นตอนหนึ่งในการลดปัญหาด้านความปลอดภัย** คือการค้นพบช่องโหว่และแก้ไข
  - มีเครื่องมือสแกนที่สามารถทำกระบวนการค้นหาช่องโหว่ของระบบเป้าหมายได้โดยอัตโนมัติ
    - ช่องโหว่เฉพาะระบบปฏิบัติการ
    - ส่วนใหญ่ไม่สามารถระบุช่องโหว่ทั้งหมดได้
    - อาจไม่ทันสมัย
  - **เครื่องมือสแกนที่สำคัญ** 
    - ISS Internet scanner, Retina
    - Open Source: Nessus project

## ดักจับข้อมูลในอินเทอร์เน็ต (Internet Traps)

**แนวคิด**
- เซ็ตของส่วนประกอบทางการทำงานและกระบวนการ
- ใช้การหลอกลวงที่ถูกกฎหมายและได้รับอนุญาต
- เบี่ยงเบนกิจกรรมของผู้บุกรุกที่เป็นไปได้จากสินทรัพย์จริงไปยังสินทรัพย์ปลอม
- รวบรวมข้อมูลการบุกรุกเพื่อการตอบสนอง

**ตัวอย่าง**
- แพ็กเก็ตอาจถูกส่งไปยังที่อยู่ IP ที่ไม่ได้ใช้หรือเครื่องดักจับ
- ไฟล์รหัสผ่านปลอมที่สามารถเข้าถึงได้
- โพสต์ข้อความว่าเครื่องจะหยุดทำงานเมื่อมันไม่ได้

## Honeypots

- ระบบที่ดูเหมือน “ทรัพยากรจริง”
  - คุณค่าของพวกเขาคือการถูกสำรวจ, โจมตี และถูกบุกรุก
  - เมื่อพวกเขาถูกสำรวจหรือโจมตี จะส่งสัญญาณเตือนให้ผู้ดำเนินการทราบว่าระบบของพวกเขาเป็นเป้าหมาย
  - ช่วยในการป้องกัน, การตรวจจับ, การตอบสนอง และการวิจัย
    - การตรวจจับง่าย เพราะไม่มีการเชื่อมต่อที่แท้จริงคาดหวัง
    - ป้องกันการสูญเสียทางเศรษฐกิจจากระบบที่ถูกใช้
- **Honeypots** ช่วยให้การบันทึกและการสังเกตการณ์ของกิจกรรมของผู้โจมตีอย่างละเอียด
  - การกดปุ่ม, เครื่องมือ, วิธีการที่ Oscar ใช้สามารถติดตามได้
- **Honeypots** ต้องจำลองช่องโหว่ แต่ในเวลาเดียวกันต้องไม่เปิดเผยว่าตนเองเป็น honeypots

## การตอบสนองต่อเหตุการณ์ (Incident Response)

**การตอบสนองต่อเหตุการณ์**
- สมมติว่ามีการโจมตีด้านความปลอดภัยหรือเหตุการณ์ที่ผิดปกติ
  - ส่งผลกระทบต่อความลับ, ความสมบูรณ์ หรือความพร้อมใช้งานของระบบ/เครือข่าย
  - ตรวจพบโดย IDS หรือเครื่องมือตรวจสอบอื่น ๆ
  - **วิธีการตอบสนอง?**
    - **การแจ้งเตือน**
      - การแจ้งเตือนต้องมีกลไกที่สำรอง (อีเมล, SMS, การแจ้งเตือนทางโทรศัพท์...)

**ขั้นตอนการตอบสนอง**
- กำหนดล่วงหน้าใครรับผิดชอบในการตอบสนองต่อการแจ้งเตือน
  - กำหนดสายการบังคับบัญชาที่ควรทราบเกี่ยวกับเหตุการณ์
- สรุปขั้นตอนการแก้ปัญหาที่ต้องมี
- หากผู้ปฏิบัติหน้าที่หลักไม่อยู่, ผู้ปฏิบัติจะเชื่อมต่อกับระบบได้อย่างไร
- หากต้องการความช่วยเหลือภายนอก, ควรติดต่อใคร - ผู้ขาย, บริษัทที่ทำสัญญาฯลฯ
- ขั้นตอนการบันทึกข้อมูลสำหรับการจับรายละเอียดของเหตุการณ์เพื่อใช้งานในอนาคต

**การจัดการเหตุการณ์ที่เป็นอันตราย**
- **การเตรียมตัว**
  - บุคลากรต้องได้รับการฝึกอบรมล่วงหน้าเกี่ยวกับสิ่งที่ต้องทำ
  - ช่องทางการสื่อสารต้องพร้อมสำหรับการตอบสนอง
- **การระบุ**
- **การควบคุม**
  - ต้องดำเนินการเพื่อป้องกันไม่ให้เกิดผลกระทบจากเหตุการณ์ขยายตัว
- **การกำจัด**
  - ปิดช่องโหว่
- **การฟื้นฟู**
  - นำระบบและเครือข่ายที่ถูกปิดให้กลับมาใช้งาน
  - ตรวจสอบให้แน่ใจว่าไม่มีทรัพยากรที่ถูกบุกรุกยังคงมีความเสี่ยง
- **การติดตามผล**
  - สิ่งที่สามารถทำได้เพื่อป้องกันไม่ให้เกิดเหตุการณ์อีก?
  - เรียนรู้อะไรจากเหตุการณ์นี้?
