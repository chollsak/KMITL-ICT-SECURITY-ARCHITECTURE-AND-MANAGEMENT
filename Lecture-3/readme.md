***Lecture 3 : SPECIFIC ATTACKS***

## ประเภทของการโจมตี
![alt text](/Lecture-3/img/classofattacks.png)

## บางข้อสังเกต

- การโจมตีเฉพาะและช่องโหว่ในโปรโตคอลจะเปลี่ยนแปลงตามเวลา
  - โปรโตคอลใหม่จะถูกใช้, การโจมตีใหม่จะถูกพัฒนา, และช่องโหว่ใหม่จะถูกตรวจพบ
  - เป็นไปไม่ได้ที่จะรู้จักและทราบการโจมตีเฉพาะทั้งหมด
  - ขั้นตอนที่ดำเนินการเพื่อลดความเสี่ยงหรือป้องกันการโจมตีอาจมีผลกระทบต่อบริการ - ความเสี่ยง vs. ต้นทุน
    - ตัวอย่าง: TCP และ DNS
- ต้องใช้แนวทางที่มีเหตุผลทั่วไป
  - การป้องกันมีความสำคัญแต่ไม่เพียงพอ
  - การตรวจจับและการตอบสนองมีความสำคัญ

**วัตถุประสงค์ในการศึกษาการโจมตีเฉพาะ**

- เพื่อให้เข้าใจว่ามีการละเมิดโปรโตคอลที่ชัดเจนและง่ายได้อย่างไรโดยผู้ที่มีเจตนาร้าย
- เพื่อเข้าใจว่าอาจจำเป็นต้องรู้รายละเอียดทั้งหมดของโปรโตคอลเพื่อระบุการโจมตี
- เพื่อรับรู้ถึงความสำคัญของบางแผนการลดความเสี่ยง/การป้องกันที่จะถูกอภิปรายในชั้นเรียนต่อไป

## แหล่งข้อมูลสำหรับการค้นพบช่องโหว่และเหตุการณ์ใหม่

- แหล่งข้อมูลที่มีประโยชน์มากคือ CERT
  - [CERT](https://www.kb.cert.org/vuls/)
  - รายการช่องโหว่ล่าสุด, เหตุการณ์, การแก้ไข และข้อเสนอแนะเพื่อลดความเสียหาย
- Thai-CERT - ทีมความพร้อมรับเหตุฉุกเฉินคอมพิวเตอร์ไทย
  - [Thai-CERT](https://www.thaicert.or.th/)
- SecurityFocus - เว็บไซต์ที่เป็นกลาง
  - [SecurityFocus](https://www.securityfocus.com)
- Packet Storm
  - [Packet Storm](http://www.packetstormsecurity.org/)
- Common Vulnerabilities and Exposures (CVE)
  - [CVE](https://cve.mitre.org/)

## การโจมตีเฉพาะ (Specific Attacks)

- **การโจมตีที่เกิดจากความล้มเหลวของโปรโตคอล**
  - การใช้ประโยชน์จาก ICMP
  - การโจมตี TCP SYN flood และการโจมตีหมายเลขลำดับ TCP
  - การโจมตี SMTP Flooding
- **การโจมตี Denial of Service (DoS) และ Distributed DoS (DDoS)**
- **การโจมตี DNS**
- **การโจมตีอีเมล**
- **โปรแกรมที่เป็นอันตราย**

## ความล้มเหลวของโปรโตคอล

**นิยาม**

- โปรโตคอลไม่พิจารณาการใช้งานที่ไม่ถูกต้องในการออกแบบและล้มเหลวในการบรรลุวัตถุประสงค์

**สาเหตุ**

- การออกแบบที่ไม่ดี (เช่น การสุ่มหมายเลขลำดับ TCP ไม่เพียงพอ)
- ข้อบกพร่องที่ยากต่อการตรวจจับยกเว้นประสบการณ์

## ความล้มเหลวของโปรโตคอลใน IP

**IPv4**

- ที่อยู่ IP ถูกใช้เป็นตัวระบุ
  - ที่อยู่ IP ถูกออกแบบมาให้เป็นตัวระบุจุดสิ้นสุดสำหรับการกำหนดเส้นทาง, ไม่ใช่เป็นตัวระบุสำหรับบริการ

**IPv6**

- การเปลี่ยนจาก IPv4 เป็น IPv6
  - ไม่มีขั้นตอนในการแยกความแตกต่างระหว่างการเปลี่ยนหมายเลขที่ถูกต้องและการเปลี่ยนแปลงที่เป็นการหลอกลวง
- การควบคุมการเข้าถึง
  - มีหลายประเภทของที่อยู่ IPv6 และการใช้พวกมันเป็นตัวระบุอาจเป็นอันตราย

## ความล้มเหลวของโปรโตคอลใน TCP

- การจับมือ 3 ทางของ TCP จำเป็นต้องใช้ SYN เพื่อจัดสรรทรัพยากร
- การโจมตีหมายเลขลำดับ TCP สำหรับการโจมตีเซสชัน
- การรีเซ็ต TCP (RST) ถูกนำไปใช้แต่ไม่แพร่หลาย

## การโจมตี TCP

- มีหลายประเภทของการโจมตีที่เป็นไปได้โดยใช้ TCP
  - **การรั่วไหลของข้อมูล**
    - สแกนพอร์ตที่เปิดเพื่อค้นหาบริการที่มีช่องโหว่ที่รู้จัก
  - **การปฏิเสธการให้บริการ**
    - ใช้พฤติกรรมของ TCP เพื่อปฏิเสธบริการสำหรับการร้องขอการเชื่อมต่อที่ถูกต้อง
  - **การโจมตีเซสชัน**
    - อนุญาตให้การเชื่อมต่อที่ถูกต้องถูกสร้างขึ้นแล้วแทรกตัวเองเข้าไปในการเชื่อมต่อ

## การโจมตี TCP SYN Flood

**TCP เป็นการเชื่อมต่อที่มุ่งหมาย**

- มีการจับมือ 3 ทางและติดตามสถานะ (หมายเลขลำดับ, ขนาดหน้าต่าง ฯลฯ)
- สถานะต้องถูกสร้างขึ้นสำหรับแต่ละการเชื่อมต่อ - โครงสร้างข้อมูลเช่น socket, ข้อมูลโปรโตคอล, เวลาในการมีชีวิต, checksum ฯลฯ
- ระบบส่วนใหญ่กำหนดขีดจำกัดในจำนวนหน่วยความจำที่สามารถจัดสรรให้กับสถานะการเชื่อมต่อ

**การโจมตี SYN Flood**

- Oscar ไม่มีเจตนาที่จะทำการจับมือ 3 ทางให้เสร็จสิ้น
  - เป้าหมายของเขาคือการเกินขีดจำกัดที่ตั้งไว้ในจำนวนการเชื่อมต่อที่รอการให้บริการ
  - ด้วยวิธีนี้, คำขอการเชื่อมต่อใหม่จะถูกทิ้ง

## วิธีการทำงาน

- พอร์ตแต่ละพอร์ตสามารถรองรับการเชื่อมต่อที่เปิดครึ่งหนึ่งได้เพียงจำนวนหนึ่ง
  - การเชื่อมต่อเหล่านี้จะถูกทิ้งหลังจากหมดเวลา
- Oscar ส่งหลายเซ็กเมนต์ TCP SYN ไปยังโฮสต์เหยื่อโดยใช้ที่อยู่ IP ปลอม
  - โฮสต์เหยื่อตอบสนองด้วย SYN ACK และรอการตอบกลับสุดท้าย
  - การตอบกลับสุดท้ายไม่เคยมาถึงทำให้เกิดความล่าช้าในการเปิดการเชื่อมต่อ
  - การเชื่อมต่อใหม่จะถูกทิ้งจนกว่าแถวจะสั้นลงแต่การท่วม SYN จะทำให้แถวไม่ต่ำกว่าขีดจำกัดในการรับการเชื่อมต่อ

**ตัวอย่างในชีวิตจริง**

- การโจมตีในเดือนกุมภาพันธ์ 2000 บน Yahoo! และเซิร์ฟเวอร์เว็บอื่นๆ

## บางข้อสังเกต

- การโจมตี SYN flood แบบ brute force ส่งแพ็กเก็ต SYN จำนวนมากที่สุดต่อหน่วยเวลา
  - ระบบตรวจจับการบุกรุกจำนวนมากสามารถตรวจจับการโจมตีเหล่านี้ได้อย่างรวดเร็ว
- การโจมตี SYN flood ที่มีความสง่างาม
  - ปลอมแปลงแพ็กเก็ตให้ดูเหมือนถูกต้อง
  - ตรวจสอบให้แน่ใจว่าที่อยู่แหล่งจริงสามารถเดินทางได้เพื่อไม่ให้ถูกบล็อก
- การหยุดการโจมตี SYN flood ได้ยาก
  - หนึ่งในวิธีแก้ไขคือการเพิ่มจำนวนการเชื่อมต่อที่เปิดโดยการเพิ่มหน่วยความจำและทรัพยากรที่เซิร์ฟเวอร์เว็บ
  - SYN floods ถูกใช้สำหรับการโจมตีเซสชัน - การโจมตีของ Mitnick

## การโจมตีด้วยหมายเลขลำดับใน TCP

### การโจมตีด้วยหมายเลขลำดับ - ภาพรวม

**กระบวนการเชื่อมต่อ TCP**

- สมมติว่า Oscar ต้องการปลอมตัวเป็นลูกค้าที่ยอมรับได้จากภายนอก LAN
  - เขาส่งแพ็กเก็ต SYN ที่มีที่อยู่ IP ปลอมไปยังเซิร์ฟเวอร์
  - เซิร์ฟเวอร์ตอบกลับลูกค้าผู้มีชื่อเสียงด้วย SYNACK
  - เพื่อทำให้การเชื่อมต่อสมบูรณ์, Oscar ต้องรู้หมายเลขลำดับเริ่มต้นของเซิร์ฟเวอร์ (`server_isn`)
  - Oscar ต้องทำการดักจับข้อมูลใน LAN หรือคาดหมายหมายเลขลำดับโดยใช้ข้อมูลที่รั่วไหล

    ![alt text](/Lecture-3/img/seq.png)

## การคาดหมายหมายเลขลำดับ

**การคาดหมายหมายเลขลำดับ**

- การนำไปใช้ของ TCP หลายเวอร์ชันใช้วิธีการสร้างหมายเลขลำดับที่คาดเดาได้
  - เวอร์ชันเก่าของการนำไปใช้ Berkeley จะเพิ่มหมายเลขลำดับ 128 ครั้งต่อวินาที
  - คำแนะนำในข้อกำหนดของ TCP คือการเพิ่มหมายเลขลำดับ 250,000 ครั้งต่อวินาที
- แนวคิดคือว่าเวลาการเดินทางไปกลับที่วัดได้หรือคาดการณ์โดย Oscar จะมีความสุ่มพอสมควรที่จะป้องกันเขาจากการคาดเดาหมายเลขลำดับ
- Oscar ยังสามารถคาดหมายช่วงของหมายเลขลำดับและส่งแพ็กเก็ตหลายชุดกลับไปยังเซิร์ฟเวอร์ - อย่างน้อยหนึ่งชุดจะถูกต้อง
  - คล้ายกับการโจมตีวันเกิดใน DNS

- เครื่องสร้างหมายเลขสุ่มสามารถถูกวิศวกรรมย้อนกลับภายใต้เงื่อนไขบางประการ
  - เก็บหมายเลขลำดับก่อนหน้า
  - วิเคราะห์พวกเขา
    - การวิเคราะห์หลายประเภทมีอยู่
    - การวิเคราะห์ระยะเฟส
  - ในบางกรณี, ด้วยความรู้เกี่ยวกับหมายเลขลำดับสามตัวก่อนหน้า, Oscar สามารถคาดหมายหมายเลขถัดไปได้ด้วยความน่าจะเป็น 100%

  ดูงานของ Michael Zalewski ที่:
  - [TCP Sequence Number Analysis](http://alon.wox.org/tcpseq.html)
  - [LCamtuf - TCP Security](http://lcamtuf.coredump.cx/newtcp/)

**ความสามารถในการโจมตีของระบบปฏิบัติการต่าง ๆ**

| ระบบปฏิบัติการ  | ความสามารถในการโจมตี |
|----------------|-------------------------|
| Win2k/XP       | 12%                     |
| Solaris        | 0.02%                   |
| Mac OS X        | 0%                      |
| Cisco IOS       | 0%                      |

## การโจมตีของ Mitnick

**การโจมตี Mitnick**

- การโจมตีนี้ใช้ SYN flood และการโจมตีเซสชันร่วมกัน
- แนวคิด:
  - อนุญาตให้การเชื่อมต่อที่ถูกต้องถูกตั้งค่าระหว่างลูกค้าและเซิร์ฟเวอร์
  - ท่วมฝ่ายหนึ่งด้วยแพ็กเก็ต SYN ทำให้ไม่สามารถตอบสนองได้
  - ปลอมตัวเป็นฝ่ายที่ถูกทำให้เงียบด้วย SYN flood

**ขั้นตอนการโจมตี**

1. ส่งแพ็กเก็ต TCP SYN ที่มีที่อยู่ IP ปลอมไปยัง X-terminal
2. X-Terminal ตอบกลับด้วย SYNACK (มันเชื่อถือที่อยู่ IP ปลอม)
3. เซิร์ฟเวอร์ที่อยู่ IP ปลอมอยู่ภายใต้การโจมตี SYN flood ดังนั้นจึงไม่สามารถตอบกลับด้วย RST ได้
4. สร้าง ACK ที่ถูกต้อง (ต้องคาดหมาย `server_isn`)
5. ส่งคำสั่งเพื่อติดตั้ง backdoors ในระบบ

**สิ่งที่การโจมตีนี้ใช้**

- การตรวจสอบที่อิงตามที่อยู่ <ไม่ดี>
- ลักษณะของ TCP ที่รู้จัก - DoS, หมายเลขลำดับที่สามารถคาดเดาได้

## การใช้พฤติกรรมของ TCP

- พฤติกรรมของ TCP สามารถถูกใช้เพื่อจำกัดอัตราการส่งข้อมูลของเซสชัน
- TCP มีสองช่วงเวลาในการควบคุมการแออัด
  - การเพิ่มแบบเชิงเส้นและลดแบบคูณ (Additive Increase Multiplicative Decrease) ที่มีช่วงเวลา 10-100 มิลลิวินาที
  - การแออัดรุนแรง - ประมาณเป็นวินาที
- ในกรณีที่สอง, หน้าต่างการควบคุมการแออัด (congestion window) จะถูกตั้งค่าเป็น 1
  - TCP จะพยายามส่งแพ็กเก็ตที่สูญหายประมาณทุก ๆ วินาที (การหมดเวลาในการส่งซ้ำ - Retransmission Time-Out หรือ RTO)
  - RTO จะถูกเพิ่มเป็นสองเท่าหากเกิดการสูญหายต่อเนื่อง

## การโจมตีที่อัตราเฉลี่ยต่ำบน TCP - 1

**แนวคิด**

- บังคับให้ TCP ไปอยู่ในช่วงเวลาที่สองโดยการกระตุ้นให้เกิดการสูญหายของแพ็กเก็ตที่รุนแรงที่เราเตอร์
- แนะนำการโจมตี DoS (Denial of Service) ที่มีการระเบิดเป็นระยะเวลาที่เท่ากับค่า RTO ของ TCP

**ผลกระทบ**

- หากการระเบิดของ DoS ติดตามค่า RTO, อัตราการส่งข้อมูลของ TCP จะถูกลดลงเป็นศูนย์
- หากค่า RTO ใกล้เคียงกับการระเบิด, อัตราการส่งข้อมูลก็ยังคงลดลง

## ผลลัพธ์ตัวอย่าง - 1
![alt text](/Lecture-3/img/exampleresult.png)
- อัตราของ DoS ไม่จำเป็นต้องสูง
  - **Sledgehammer** เปรียบเทียบกับ **Shrew**
- เมื่อช่วงเวลาเพิ่มขึ้น, อัตราของ DoS จะลดลง
  - ผลกระทบยังคงสามารถสูงได้
- ส่งผลต่อการไหลของ TCP แต่ละรายการรวมถึงการรวมกลุ่ม (aggregates)

## ความล้มเหลวของโปรโตคอลใน ICMP

### ICMP
- ICMP ใช้บ่อยในอุปกรณ์เครือข่ายและโฮสต์
- การกระจาย ICMP ได้รับอนุญาตจากเครือข่ายภายนอก
- ที่อยู่ IP broadcast ได้รับอนุญาตสำหรับ ICMP
- คำขอและการตอบกลับ Echo สามารถใช้ได้ง่ายโดยอุปกรณ์หรือโฮสต์ใด ๆ
- ข้อความ ICMP Route Redirect อาจถูกใช้ในทางที่ผิด

## การโจมตี ICMP (Flooding)

### การโจมตี Smurf
- เงื่อนไขที่จำเป็น:
  - เครือข่ายกลางอนุญาตให้ ICMP broadcast requests จากภายนอก
  - เครือข่ายกลางมีโฮสต์จำนวนมากและแบนด์วิธสูง
  - เป้าหมายมีแบนด์วิธต่ำ
- Oscar สามารถส่งคำขอ ICMP broadcast ไปยังโหนดทั้งหมดในเครือข่ายกลาง
- โหนดเหล่านี้จะขยายคำขอ ICMP ด้วยการตอบกลับที่ท่วมเครือข่ายเป้าหมาย ส่งผลให้เกิดการปฏิเสธการให้บริการ
- **Tribe Flood Network (TFN)**:
  - เป็นการโจมตี DDoS ที่มีซอมบี้ที่ทำการโจมตี TCP SYN Flood, Smurf หรือ UDP flooding
  - การสื่อสารระหว่าง Master และ Zombies ใช้การตอบกลับ ICMP echo

## การโจมตี ICMP (โค้ดอันตราย Malicious Code)

### Winfreeze
- ทำให้โฮสต์ที่เปราะบางโจมตีตนเอง
- ใช้ข้อความ ICMP route redirect
- ผู้เสียหายได้รับข้อความที่บอกว่าทางที่เหมาะสมที่สุดไปยังที่อยู่ IP ที่สุ่มคือโฮสต์ของผู้เสียหายเอง
- ทำงานบนโฮสต์ Windows NT ที่เปราะบางบางตัว

### Loki (ICMP Tunneling)
- Loki เป็นเทพเจ้าแห่งการหลอกลวงและอุบาย
- Loki ติดตั้งตัวเองเป็นเซิร์ฟเวอร์บนโฮสต์ที่ถูกบุกรุกและใช้ ICMP เป็นโปรโตคอลการส่งผ่านข้อมูลเพื่อติดต่อกับลูกค้า
- Loki server สามารถส่งไฟล์ทั้งหมดจากโฮสต์ที่ถูกบุกรุกไปยังลูกค้า

## การโจมตี ICMP (การรวบรวมข้อมูล)

### Trace Route
- คำสั่ง traceroute ใช้เพื่อค้นหาเส้นทางที่แพ็คเก็ตใช้เมื่อเดินทางไปยังปลายทางของมัน

### Port Scanning
- ข้อความข้อผิดพลาด ICMP (Protocol/Port Unreachable) สามารถใช้ในการค้นหาพอร์ตที่เปิดให้กับที่อยู่ IP หรือ LAN segment

### OS Fingerprinting
- การ fingerprinting เป็นเทคนิคในการค้นหาประเภทของระบบปฏิบัติการที่เซิร์ฟเวอร์กำลังใช้งานโดยดูที่การตอบสนองของแพ็คเก็ต ICMP

### ICMP Route Discovery
- โปรโตคอลการค้นพบ ICMP router จะค้นหาที่อยู่ IP ของเราเตอร์เพื่อนบ้าน ข้อความการค้นพบ ICMP router เรียกว่า “Router Advertisements” หรือ “Router Solicitations”

## ความล้มเหลวของโปรโตคอล SMTP

### SMTP
- ไม่มีการตรวจสอบสำหรับ SMTP
- SMTP agent ส่งข้อความไปยังเซิร์ฟเวอร์ SMTP โดยไม่ต้องมีการแทรกแซงจากมนุษย์
- เซิร์ฟเวอร์อีเมลที่รับมักจะสนใจที่อยู่ของผู้รับมากกว่าที่อยู่ของผู้ส่ง

## การโจมตี SMTP Flooding

### การโจมตี SMTP
- ผู้โจมตีสามารถใช้สิ่งนี้โดยการปลอมตัวเป็นผู้ส่งที่ถูกต้อง
- ผู้โจมตีสามารถโจมตีผู้รับด้วยการโจมตี Denial of Service โดยการกรอกกล่องจดหมายของผู้รับด้วยไฟล์ขนาดใหญ่หรืออีเมลจำนวนมากที่เรียกว่า SPAM
- การปลอมตัวที่อยู่ Email ของแหล่งที่มาจูงใจเหยื่อให้ทำตามคำแนะนำหรือคลิกลิงก์ในอีเมล
  - เรียกว่า **Phishing Attack**

## ความล้มเหลวของโปรโตคอลทั่วไปอื่น ๆ

### WEP (Wired Equivalent Privacy)
- ใช้ stream cipher ซึ่งสามารถทำซ้ำคีย์สตรีมได้บ่อย
- ใช้ CRC สำหรับตรวจสอบความถูกต้อง
- ง่ายต่อการถอดรหัส แก้ไขและแทรกข้อมูล

### MIME
- ถือว่าเนื้อหาของอีเมลน่าเชื่อถือ
- สามารถดึงไฟล์จากไซต์ FTP และประกอบใหม่โดยเขียนทับไฟล์ที่มีชื่อเดียวกันที่มีอยู่
- ไวรัสสามารถหลีกเลี่ยงการตรวจจับโดยการใช้ fragmentation

### RPC และ RPCbind
- ใช้หมายเลขพอร์ตใด ๆ ที่กำหนดให้พวกเขา
- ยากต่อการตรวจจับโดยใช้การกรองแพ็คเก็ต

---

<br>

# Denial of Service 
**ATTACKS ON AVAILABILITY**

## การโจมตี Denial of Service (DoS)

### การโจมตี Denial of Service
- การโจมตีต่อความพร้อมใช้งานของทรัพยากร
  - แบนด์วิธ ข้อมูล ทรัพยากรคอมพิวเตอร์ ซอฟต์แวร์ที่ฝั่งลูกค้าหรือเซิร์ฟเวอร์ ฯลฯ
  - มีการประเมินว่ามีการโจมตีระหว่าง 20 ถึง 40 ครั้งต่อชั่วโมง
- ประเภทของการโจมตี
  - **Network Denial of Service**: มักเกี่ยวข้องกับการท่วมเป้าหมายด้วยแพ็คเก็ตที่ชั้นลิงก์หรือเครือข่าย
  - **Service Denial**: ให้ข้อมูลที่ผิดพลาด ขัดจังหวะข้อมูล หรือทำให้เซิร์ฟเวอร์ล้มเหลว
  - **DoS บนฝั่งลูกค้า**: ทำให้ซอฟต์แวร์ลูกค้าล้มเหลว
- การป้องกันการโจมตี Denial of Service เป็นเรื่องที่ยาก
  - การฟ้องร้องอาจจะง่าย แต่การติดตามผู้กระทำผิดยาก

## การโจมตี Network Link Flooding

### ความคิด
- สร้างปริมาณการจราจรบนลิงก์มากกว่าความจุของลิงก์
- ตัวอย่าง: ลิงก์ T1, 200 KBps เป็นพอเพียง
- ข้อกำหนด:
  - ลิงก์ที่เชื่อมต่อจะต้องมีความจุมากกว่าลิงก์เป้าหมาย

### ตัวอย่าง
- **Directed Broadcast (ICMP) – Smurf Attack**
- **SMTP Flooding และ SPAM**
  - ส่งไฟล์ขนาด 10 MB จากหลายลูกค้าไปยังเซิร์ฟเวอร์อีเมลเดียวอย่างรวดเร็ว
- **Small Services Attacks**
  - คำสั่งอย่าง echo บน UNIX ใช้สำหรับการบำรุงรักษาแต่สามารถใช้สำหรับการโจมตีแบบ Smurf
  - ค้นหาเซิร์ฟเวอร์ echo สองตัวและส่งแพ็คเก็ตจากหนึ่งไปยังอีกตัวหนึ่งสร้างลูปไม่มีที่สิ้นสุด

## การโจมตีบริการ

### การโจมตี TCP SYN Flood
- สร้างหลายการเชื่อมต่อที่เปิดครึ่งหนึ่งเพื่อให้คำขอที่แท้จริงถูกละเลย

### การโจมตี BGP
- ข้อความการกำหนดเส้นทางปลอมทำให้แพ็คเก็ตไม่ถึงปลายทาง

### การโจมตี NIS bogus backup server
- บริการ NIS มีเซิร์ฟเวอร์สำรอง
- หากที่อยู่ของเซิร์ฟเวอร์สำรองถูกปลอมแปลง บริการ NIS อาจได้รับผลกระทบ

### การลบการลงทะเบียนบริการด้วย RPCbind
- ข้อความการลบการลงทะเบียนที่ปลอมแปลงไปยัง rpcbind อาจป้องกันการใช้งานบริการ rpc จริง

## การโจมตีฝั่งลูกค้า

### URL ที่ออกแบบมาเป็นพิเศษ
- ทำให้เบราว์เซอร์ล้มเหลว
- ทำให้เมาส์ค้าง
- สร้างการแจ้งเตือนที่ผิดพลาด

### Java Applets
- เปิดหน้าต่างมากเกินไปจนลูกค้าไม่มีทรัพยากรทำสิ่งอื่น

## Distributed Denial of Service (DDoS)

### การโจมตี DDoS
- ได้รับความสนใจอย่างมากนับตั้งแต่การโจมตีในเดือนกุมภาพันธ์ 2000 ต่อเว็บไซต์ที่เป็นที่นิยม
- วิธีการทำงานทั่วไป
  - Oscar ใช้ข้อบกพร่องและประตูหลังเพื่อติดตั้งโปรแกรมซอมบี้หรือเอเจนต์ในหลายเครื่องในหลายโดเมน
  - Oscar ติดตั้งโปรแกรมหลักบนเครื่องอื่นพร้อมรายการของซอมบี้
  - Oscar รอ
  - เมื่อถึงเวลาการโจมตี เขาส่งข้อความไปยังโปรแกรมหลักเพื่อระบุที่อยู่ของเป้าหมาย
    - ข้อความอาจเข้ารหัส
  - โปรแกรมหลักส่งข้อความไปยังซอมบี้ทั้งหมดเพื่อโจมตีเป้าหมาย
  - ซอมบี้เปิดการโจมตี – ท่วมลิงก์หรือเซิร์ฟเวอร์เป้าหมาย
    - อาจเป็นการโจมตี Smurf, TCP SYN flood, UDP flood เป็นต้น

## Botnets

### การใช้งานของ Botnets
- ซอมบี้ใน Botnet ไม่ทั้งหมดใช้ในการโจมตี DDoS
  - Oscar สร้างเครือข่ายขนาดใหญ่ของซอมบี้หรือบอท
- การใช้งานของ Botnets
  - การโจมตี DDoS
  - การส่งสแปม
  - การสแกนช่องโหว่ที่กระจาย
  - การวิเคราะห์การเข้ารหัส

### วิธีการสร้าง Botnets
- มักใช้ข้อบกพร่องและประตูหลัง

## การจำแนกประเภทการโจมตี DDoS

### การจำแนกประเภท
- **Degree of Automation**: อัตโนมัติทั้งหมด, อัตโนมัติบางส่วน, หรือแมนนวล
- **Exploited Weakness to Deny Service**: จุดอ่อนที่ใช้เพื่อปฏิเสธบริการ
- **Source Address Validity**: ความถูกต้องของที่อยู่แหล่ง
- **Attack Rate Dynamics**: พลศาสตร์ของอัตราการโจมตี
- **Possibility of Characterization**: ความเป็นไปได้ในการจำแนกประเภท
- **Persistence of Agent Set**: ความคงอยู่ของชุดเอเจนต์
- **Victim Type**: ประเภทของเหยื่อ
- **Impact on Victim**: ผลกระทบต่อเหยื่อ

### Degree of Automation - I

- **Manual**:
  - Oscar ต้องสแกนเครื่องด้วยตนเองเพื่อหาข้อบกพร่อง เข้าสู่ระบบและเริ่มการโจมตี
- **Semiautomatic**:
  - มี "Master" และ "Agent" (ซอมบี้)
    - การสรรหา การใช้ประโยชน์ และการติดเชื้อเป็นอัตโนมัติ
  - Oscar ยังสั่งการเอเจนต์ - ประเภทของการโจมตี เหยื่อ ระยะเวลา เวลาผ่านโปรแกรมหลัก
    - การสั่งการอาจเป็นทางตรงหรือทางอ้อม
      - ทางตรง => โปรแกรมหลักต้องรู้ว่าเอเจนต์คือใครและในทางกลับกัน => ที่อยู่ IP ของโปรแกรมหลักถูกกำหนดไว้อย่างแน่นอนในเอเจนต์
        - การตรวจจับง่ายกว่า
      - ทางอ้อม => ใช้ช่องทาง IRC หรือช่องทางลับอื่น ๆ สำหรับการสื่อสาร
        - การตรวจจับยากกว่า

- **Automatic**:
  - เฟสการใช้งานก็เป็นอัตโนมัติ
  - หลีกเลี่ยงความจำเป็นในการสื่อสารระหว่าง Master และ Agents
  - โค้ดการโจมตีถูกโปรแกรมไว้ล่วงหน้า
    - เวลาเริ่มต้นของการโจมตี เหยื่อ ประเภทของการโจมตี ระยะเวลา ฯลฯ
  - ผู้โจมตีเปิดเผยน้อยมาก
  - ข้อเสีย - ขาดความยืดหยุ่น

## กลยุทธ์การสแกน

### การสแกนอัตโนมัติและกึ่งอัตโนมัติ
- ใช้เวิร์มหรือโทรจัน
  - รายงานการสแกนถึง 3 ล้านครั้งต่อวันตามการวิเคราะห์จากบันทึกไฟร์วอลล์จาก 1600 เครือข่าย
- การสแกนมีสองเฟส - การสแกนโฮสต์และการสแกนช่องโหว่
  - โฮสต์ที่เลือกอาจเป็นแบบสุ่ม มีรายการที่ต้องการ หรืออื่นๆ
  - สามารถสแกนพอร์ตเฉพาะในเครื่องทั้งหมดหรือใช้รายการ
  - อาจเป็นการประสานงานและ/หรือซ่อนเร้น

## การแพร่กระจาย

### แหล่งข้อมูลกลาง
- เมื่อพบช่องโหว่ โค้ดสำหรับการติดเชื้อจะถูกดาวน์โหลดจากเซิร์ฟเวอร์กลาง
  - จุดล้มเหลวเดียว
  - ตรวจจับและปิดการทำงานได้ง่าย
  - ตัวอย่าง: หนอน 1i0n

### Back-chaining
- โฮสต์ที่ทำการสแกนยังให้โค้ดสำหรับการติดเชื้อ
  - เมื่อได้รับการติดเชื้อ โฮสต์ใหม่จะเริ่มกระบวนการเดียวกัน
  - หนอน Ramen และ Morris ใช้เทคนิคนี้

### อัตโนมัติ
- การสแกนและการดาวน์โหลดเกิดขึ้นในขั้นตอนเดียว - หนอน Code-Red, หนอนที่ใช้ E-mail

## ช่องโหว่ที่ถูกใช้

### Semantic
- ใช้ "ความหมาย" หรือคุณสมบัติของโปรโตคอล
  - ตัวอย่าง: การโจมตี TCP SYN Flood ใช้ความจริงที่ว่าเซิร์ฟเวอร์จัดสรรทรัพยากรมากมายให้กับการเชื่อมต่อ TCP เมื่อได้รับส่วน SYN

### Brute Force
- เริ่มต้นการทำธุรกรรมจำนวนมากที่ดูเหมือนจะถูกต้อง
  - ตัวอย่าง: การส่งอีเมลขนาดใหญ่จำนวนมาก
  - โดยปกติจะต้องการปริมาณการจราจรที่สูงขึ้น

## ความถูกต้องของที่อยู่แหล่งข้อมูล

### ที่อยู่แหล่งข้อมูลที่ถูกต้อง
- เครื่องบางเครื่องไม่สามารถใช้การปลอมแปลงที่อยู่ IP ได้เนื่องจากฟังก์ชันดังกล่าวไม่สามารถใช้งานได้บน OS
  - ตัวอย่าง: Win95 และ Win98

### ที่อยู่แหล่งข้อมูลที่ปลอมแปลง
- เป็นประโยชน์มากที่สุดสำหรับ Oscar
  - มีหลายประเภทและเหตุผลสำหรับการปลอมแปลงที่อยู่

### ที่อยู่แหล่งข้อมูลที่สามารถกำหนดเส้นทางได้
- เพื่อสะท้อนการตอบสนองและปฏิเสธบริการต่อโฮสต์ที่ที่อยู่ของมันถูกแฮ็ก

### ที่อยู่แหล่งข้อมูลที่ไม่สามารถกำหนดเส้นทางได้
- ใช้ที่อยู่ที่สงวนไว้เช่น 192.168.0.0/16
  - สามารถถูกทิ้งได้ง่าย
- ใช้ที่อยู่ที่ถูกต้องแต่ไม่ได้ใช้งานในเครือข่าย
  - สามารถให้ข้อมูลที่มีประโยชน์ผ่านการติดตามและการกลับกระจัดกระจาย

## เทคนิคการปลอมแปลง

### การปลอมแปลงแบบสุ่ม
- สร้างหมายเลข 32 บิตแบบสุ่มและใช้

### ที่อยู่แหล่งข้อมูลที่ปลอมแปลงแบบ Subnet
- ใช้ที่อยู่ที่เป็นของพื้นที่ subnet ของเครื่องเอเจนต์
  - ตัวอย่าง: หากเครื่องเอเจนต์เป็น 136.142.117.0/24, สามารถปลอมแปลงที่อยู่ใดๆ ในช่วง 136.142.117.1 - 136.142.117.254

### ที่อยู่แหล่งข้อมูลที่ปลอมแปลงระหว่างการเดินทาง
- ใช้ที่อยู่ของเครื่องที่อยู่ใน subnet ตามเส้นทางไปยังปลายทาง
  - ไม่มีตัวอย่างที่รู้จัก

### ที่อยู่แหล่งข้อมูลที่ปลอมแปลงแบบ Fixed
- พยายามที่จะแก้ไขข้อกล่าวหาบนรายการโฮสต์ที่เฉพาะเจาะจง

## พลศาสตร์ของอัตราการโจมตี

### อัตราการโจมตี
- **อัตราคงที่**: มักเริ่มต้นทันทีและท่วมท้นเหยื่อ
- **อัตราที่เปลี่ยนแปลงได้**: เพิ่มอัตราทีละน้อยเพื่อหลีกเลี่ยงการตรวจจับอย่างรวดเร็ว
  - อัตราที่ผันผวน - การเต้นเป็นจังหวะ, รอบระยะเวลา และอื่นๆ

## ความสามารถในการจำแนกประเภท

### สามารถจำแนกประเภทได้
- ใช้ข้อมูลโปรโตคอล TCP, IP และอื่นๆ เพื่อระบุประเภทของการโจมตี
  - ตัวอย่าง: การโจมตี TCP SYN Flood
- ประเภท:
  - **Filterable**: เช่น หากมีการโจมตี UDP หรือ ICMP, เซิร์ฟเวอร์เว็บที่ใช้พวกมันน้อยสามารถบล็อกได้
  - **Non-filterable**: เช่น การโจมตี HTTP floods ไปยังเซิร์ฟเวอร์เว็บหรือการโจมตี DNS request floods ไปยังเซิร์ฟเวอร์ชื่อ

### ไม่สามารถจำแนกประเภทได้
- การโจมตีที่ใช้การผสมผสานของ TCP SYN, ICMP, TCP ACK, UDP Flood packets
  - ต้องการการตรวจสอบอย่างรอบคอบและการจำแนกประเภทมักจะเป็นเรื่องของการตีความ

## ความคงทนของชุดเอเจนต์

### ชุดเอเจนต์
- ชุดเอเจนต์ยังคงเหมือนเดิมหรือเปลี่ยนแปลงตามเวลา
  - หากชุดเอเจนต์เปลี่ยนแปลงตามเวลา จะยากขึ้นในการติดตามผู้กระทำผิด
- **ชุดเอเจนต์ที่คงที่**
  - พวกเขาทั้งหมดทำงานในลักษณะเดียวกัน
  - พวกเขาได้รับชุดคำสั่งเดียวกัน
- **ชุดเอเจนต์ที่เปลี่ยนแปลงได้**
  - Oscar แบ่งชุดเอเจนต์ออกเป็นกลุ่มย่อย
  - หนึ่งหรือหลายกลุ่มย่อยจะถูกใช้ในเวลาเดียวกัน
  - เอเจนต์อาจสังกัดหลายกลุ่มย่อย

## ประเภทของเหยื่อ

### Application
- วัตถุประสงค์ของการโจมตีคือการทำให้บริการไม่ทำงาน
  - ตัวอย่าง: การโจมตีลายเซ็นปลอมบนเซิร์ฟเวอร์การพิสูจน์ตัวตน
  - ยากที่จะตรวจจับการโจมตีที่มุ่งเน้นแอปพลิเคชัน

### Host
- วัตถุประสงค์คือการทำให้โฮสต์ไม่ทำงาน - ล้มเหลว รีบูต หรือแช่แข็ง
  - ตัวอย่าง: การโจมตี TCP SYN Flood
  - แพ็คเก็ตการโจมตีทั้งหมดจะมีที่อยู่ปลายทางของโฮสต์นั้น
  - ตรวจจับง่าย

### Resource
- วัตถุประสงค์คือการทำให้ทรัพยากรที่สำคัญ เช่น เซิร์ฟเวอร์ชื่อ เราเตอร์ หรือการเชื่อมต่อไม่ทำงาน

### Network
- ใช้แบนด์วิธของเครือข่าย
  - ที่อยู่ปลายทางสามารถเป็นโฮสต์ใดๆ ใน subnet

### Infrastructure
- วัตถุประสงค์คือการทำให้การดำเนินงานของอินเทอร์เน็ตทั่วโลกหรือบางส่วนไม่ทำงาน
  - ตัวอย่าง: การโจมตีเซิร์ฟเวอร์ชื่อหลัก เราเตอร์หลัก เซิร์ฟเวอร์ใบรับรอง และอื่นๆ

## ผลกระทบต่อเหยื่อ

### การหยุดชะงัก
- ปฏิเสธการเข้าถึงโดยสิ้นเชิง

### การฟื้นตัวแบบไดนามิก
- อาจสามารถฟื้นตัวระหว่างหรือหลังการโจมตี
  - ตัวอย่าง: แบนด์วิธเครือข่าย
  - การฟื้นตัวด้วยตนเอง การแทรกแซงของมนุษย์สำหรับการฟื้นตัวและกรณีที่ไม่สามารถฟื้นตัวได้

### การเสื่อมโทรม
- ปฏิเสธการเข้าถึงบางส่วนแต่มีค่าใช้จ่ายทางเศรษฐกิจอย่างมาก

## ความท้าทายในการป้องกันการโจมตี DDoS

### ขาดข้อมูลการโจมตีรายละเอียด
- การวิเคราะห์การโจมตีเฉพาะมีอยู่
- ข้อมูลเกี่ยวกับความถี่ การแจกจ่าย จำนวนเอเจนต์ ประสิทธิภาพของการตอบสนองยังไม่พร้อม

### ขาดการเปรียบเทียบ
### ความยากลำบากในการทดสอบขนาดใหญ่
- การป้องกันที่เฉพาะเจาะจงในขนาดใหญ่ดีแค่ไหน?
- ความต้องการการตอบสนองแบบกระจาย
  - ต้องมีการประสานงานข้ามโดเมนการบริหาร
- ปัจจัยทางเศรษฐกิจและสังคม

## การฟื้นตัวจาก DDoS

### การบรรเทาความเสียหายเป็นไปได้ แต่ไม่ใช่ทางออกที่สมบูรณ์
- เทคนิคในการบรรเทาความเสียหาย:
  - การกรองข้อมูลที่เข้ามาที่ขอบ
  - การป้องกัน การตรวจจับ และการตอบสนอง
    - กรองแพ็คเก็ตที่ไม่ดี (คำถามคือวิธีการ?)
    - ปรับปรุงความเร็วในการประมวลผลข้อมูล
    - เพิ่มฮาร์ดแวร์และความจุของลิงก์เพื่อจัดการกับโหลดปกติ + การโจมตี
    - ติดตามและปิดไซต์ที่โจมตี

## IP Traceback

### การติดตาม IP
- การตรวจสอบว่าแพ็คเก็ตที่เกี่ยวข้องกับ DoS มาจากที่ใด
- **ประเภทของการติดตาม:**
  - **การสอบถามเราเตอร์อย่างกระตือรือร้น:**
    - เหยื่อพัฒนาลายเซ็นของการโจมตีและดำเนินการตรวจสอบทีละฮอปเพื่อดูว่าแพ็คเก็ตมาจากที่ใด
  - **สร้างเครือข่ายเสมือนเพื่อการตรวจสอบการไหลและการบันทึก:**
    - สร้างเครือข่ายเสมือนเพื่อการตรวจสอบที่เลือกและบันทึกข้อมูล
  - **การระบุตำแหน่งโดยการสร้างเส้นทางด้วย “การทำเครื่องหมายแพ็คเก็ต” ที่น่าจะเป็นไปได้:**
    - ใช้เทคนิคการทำเครื่องหมายแพ็คเก็ตเพื่อติดตามเส้นทางของแพ็คเก็ต

## Backscatter

### ความสำคัญ
- ใช้ในการระบุความแพร่หลายของการโจมตี DoS
- **แนวคิด:**
  - ดักจับแพ็คเก็ตที่ตอบสนองต่อแพ็คเก็ต DoS ที่ปลอมแปลงที่อยู่ IP ที่ไม่ได้ใช้งาน
  - หาก Oscar เลือกที่อยู่ IP แบบสุ่มและแพ็คเก็ตถูกจับในพื้นที่ที่อยู่ที่ใหญ่พอสมควร พวกมันจะให้ “ตัวอย่าง” ที่ดีสำหรับการวิเคราะห์

### ตัวอย่างการศึกษา
- นักวิจัย AT&T ได้ทำการศึกษาเรื่องนี้ (ดูหน้า 116-117 ของ FIS)
- ศูนย์ซุปเปอร์คอมพิวเตอร์ในซานดิเอโกก็ได้ทำการวิเคราะห์นี้เช่นกัน

### แหล่งข้อมูลเพิ่มเติม
- [Backscatter Paper](http://www.caida.org/outreach/papers/2001/BackScatter/)

<br>

# DNS Attacks
**EXAMPLES OF SPECIFIC DOS ATTACK ON DNS PROTOCOL**

## การโจมตี DNS บางส่วน
**Bugs and backdoors**
- ช่องโหว่ใน BIND

 **Information Leakage**
- Zone transfer attacks การโจมตีการถ่ายโอนโซน

 **Denial of Service**
- DNS Tainting or Cache Poisoning

 **Birthday Attack**

## ช่องโหว่ใน BIND
  - BIND (Berkeley Internet Name Domain) ถูกใช้โดยเซิร์ฟเวอร์ DNS ส่วนใหญ่
  - ตัวอย่างหนึ่งแสดงให้เห็นว่า 45% ของการตอบสนองระบุว่าใช้บางเวอร์ชันของ BIND
  - เวอร์ชันต่างๆ ของ BIND มีช่องโหว่ที่แตกต่างกัน เช่น Buffer overflow, ความอ่อนไหวต่อ DoS, การรั่วไหลของข้อมูล
  - ในเดือนพฤษภาคม 2004, เซิร์ฟเวอร์หลักหลายแห่งยังคงใช้เวอร์ชันที่มีช่องโหว่
  - **ข้อมูลเพิ่มเติม:**
    - CERT Advisory: [CA-2002-19](http://www.cert.org/advisories/CA-2002-19.html)
  - **แหล่งข้อมูล:** M. Schiffman, “Bound By Tradition: A Sampling of the Security Posture of the Internets DNS Servers,” [Packet Factory](http://www.packetfactory.net/)

## Impact
- **การดำเนินการของ DNS ด้วยสิทธิ์ root:**
  - ข้อมูลเกี่ยวกับช่องโหว่ที่เผยแพร่โดย `dig` อาจถูกใช้เพื่อโจมตีหรือทำ DoS
  - หลายโปรโตคอลอื่นๆ ใช้ BIND ในการแก้ไขชื่อและที่อยู่ เช่น Sendmail อาจใช้ประโยชน์จากช่องโหว่ของ BIND
  - **การโจมตีใหญ่ (2001):**
    - เวิร์ม erkms และ 1i0n ใช้ช่องโหว่ของ BIND ในการโจมตี DDoS
  - ช่องโหว่บางอย่างอาจดูเล็กน้อย แต่ยังคงเป็นปัญหา เช่น BIND v9 (ก่อน 9.2.1) สามารถถูกปิดได้หากมีการส่งแพ็คเก็ตที่ถูกสร้างขึ้นเป็นพิเศษ
    - **ข้อมูลเพิ่มเติม:** [CERT Advisory: CA-2002-15](http://www.cert.org/advisories/CA-2002-15.html)

## Tainting DNS Responses
- **แนวคิดการทำให้ข้อมูล DNS เสีย:**
  - หากโฮสต์ที่เป็นอันตรายสามารถสวมรอยเป็นโฮสต์ที่ถูกต้องได้ ก็สามารถเข้าถึงทรัพยากรมากมาย
  - รุ่นของ BIND ก่อน 8.1.1 มีช่องโหว่
  - **แนวคิด:**
    - การแคชข้อมูลที่เป็นอันตรายหรือหลอกลวงจากเซิร์ฟเวอร์ชื่อภายนอกในเซิร์ฟเวอร์ชื่อของเหยื่อ
    - ขั้นตอน:
      - หลอกให้เซิร์ฟเวอร์ชื่อของเหยื่อส่งคำถามไปยังเซิร์ฟเวอร์ชื่อของ Oscar
      - ตอบกลับด้วยข้อมูลที่เสียหาย (corrupted RR) ที่เซิร์ฟเวอร์ชื่อของเหยื่อจะเก็บไว้
    - แพ็คเก็ต DNS ประกอบด้วยคำถามและคำตอบ
      - รุ่นเก่าของ BIND ใช้หมายเลขลำดับที่ไม่เป็นแบบสุ่มทำให้ง่ายต่อการปลอมแปลงการตอบกลับและคำถาม DNS

## การโจมตี DNS

### การคาดการณ์หมายเลขลำดับ DNS
![alt text](/Lecture-3/img/predict.png)

- **แหล่งข้อมูล:** [DNS Cache Poisoning, The Next Generation - By Joe Stewart](http://www.securityfocus.com/guest/17905)

### ตัวอย่างจริง

- **ตัวอย่างที่ 1:**
  - Oscar ส่งคำถาม DNS สำหรับที่อยู่ IP ของ www.hillary2000.org พร้อมกับแนบการตอบกลับ (a.b.c.d) ด้วย
  - คำถามถูกส่งไปยังเซิร์ฟเวอร์ DNS หลายตัว
  - BIND ที่มีบั๊กในบางเซิร์ฟเวอร์ DNS จะเก็บข้อมูลตอบกลับ (a.b.c.d) ซึ่งจริงๆ แล้วเป็นข้อมูลของเว็บไซต์ www.hillaryno.com
  - ผู้ใช้พยายามเข้าถึง hillary2000.org แต่ถูกส่งไปยัง hillaryno.com
  - **แหล่งข้อมูล:** Northcutt & Novak, Network Intrusion Detection, An Analyst’s Handbook

- **ตัวอย่างที่ 2:**
  - ใช้ SPAM หรือป๊อปอัพที่ผู้ใช้คลิกโดยไม่ตั้งใจหรือโดยเจตนา
  - เซิร์ฟเวอร์ DNS ของผู้ใช้ส่งคำถามไปยังเซิร์ฟเวอร์ DNS ของ Oscar
  - เซิร์ฟเวอร์ของ Oscar ทำให้แคช DNS ของเซิร์ฟเวอร์ DNS ของเหยื่อเสีย
  - การโจมตีจริงต่อเซิร์ฟเวอร์ DNS ของ Microsoft ในปี 2001
    - **ข้อมูลเพิ่มเติม:** [CERT IN-2001-11](http://www.cert.org/incident_notes/IN-2001-11.html)

## การโจมตีแบบ Birthday Attack ต่อ DNS

- **เวอร์ชันใหม่ของ BIND ใช้หมายเลขลำดับแบบสุ่ม (65535 ค่าที่เป็นไปได้) ในคำถาม DNS**
- Oscar สามารถปลอมแปลงหมายเลขสุ่มในการตอบกลับเพื่อทำให้แคช DNS เสียได้อย่างไร?
- **วิธีการ:**
  - ช่องโหว่ในเวอร์ชันของ BIND: เซิร์ฟเวอร์ DNS ส่งหลายคำถามสำหรับชื่อเดียวกันหากได้รับคำร้องจากหลายโฮสต์ - Birthday Attack
  - คาดหมายหมายเลขลำดับแบบสุ่ม
  - การโจมตีแรกเกี่ยวข้องกับ Oscar ส่งคำถามปลอมจำนวนมากไปยังเซิร์ฟเวอร์ DNS ของเหยื่อ (ต้องส่งคำถามกี่คำสำหรับความน่าจะเป็น 50% ของการคาดหมายหมายเลขลำดับถูกต้อง?)
  - ส่งการตอบกลับปลอมไปยังเซิร์ฟเวอร์ DNS ของเหยื่อ

## การโจมตี DoS ต่อเซิร์ฟเวอร์ราก

- **วันที่ 21 ตุลาคม 2002:** การโจมตี DDoS ต่อเซิร์ฟเวอร์ราก
  - โซเซอร์ใน Botnet เปิดการโจมตี ping flood ต่อเซิร์ฟเวอร์ราก 13 ตัว
    - ping ถูกใช้เพื่อเช็คว่าเซิร์ฟเวอร์รากยังทำงานอยู่
    - เซิร์ฟเวอร์ 7 ตัวถูกทำลายอย่างสมบูรณ์
    - เซิร์ฟเวอร์ 4 ตัวยังคงทำงานได้
  - ส่วนใหญ่ไม่พบการหยุดชะงักใดๆ
    - การแคช DNS ช่วยให้คำถาม DNS ส่วนใหญ่ทำงานได้ตามปกติ
  - การโจมตี DDoS หยุดลงอย่างกะทันหันหลังจาก 1 ชั่วโมง ซึ่งแตกต่างจากการโจมตี DDoS อื่นๆ ที่ค่อยๆ จางหายไปหรือต้องหยุด
  - **การบรรเทาผลกระทบ:**
    - ใช้ที่อยู่ anycast และกระจายเซิร์ฟเวอร์ราก
    - ดาวน์โหลดแผนที่โซนเซิร์ฟเวอร์รากทุกวันไปยังเซิร์ฟเวอร์ชื่อท้องถิ่น

## การโจมตีทางอีเมล

### การหลอกลวง (Hoax)

- **อีเมลที่ขอให้ทำสิ่งที่ไร้สาระ:**
  - ตัวอย่าง: Chain email, การชนะลอตเตอรี่ ฯลฯ

### SPAM

- **อีเมลที่รบกวนผู้รับ:**
  - ส่วนใหญ่ส่งเป็นจำนวนมากไปยังผู้รับ ทำให้เกิดการติดขัดของข้อมูล

### ฟิชชิง (Phishing)

- **อีเมลที่ล่อให้ผู้รับทำสิ่งที่เกี่ยวข้องกับการกระทำทางการเงิน:**

## การโจมตีแบบ Exponential

- **เวิร์มและไวรัสสามารถแพร่กระจายได้อย่างรวดเร็ว:**
  - ใช้ช่องโหว่ในซอฟต์แวร์และโปรโตคอล
  - แพร่กระจายไปทั่วโลกภายในไม่กี่นาที
  - อาจทำให้เกิดความเสียหายทางเศรษฐกิจอย่างรุนแรง
- **วิธีแก้ปัญหาส่วนใหญ่เป็นแบบตอบสนอง:**
  - ซอฟต์แวร์ตรวจจับไวรัส
  - ปิดการใช้งานบริการที่ไม่จำเป็นโดยค่าเริ่มต้น
  - หลีกเลี่ยงการใช้ Monoculture

## โปรแกรมที่เป็นอันตราย (Malware)
![alt text](/Lecture-3/img/malware.png)

### โปรแกรมที่เป็นอันตราย

- **ต้องการโปรแกรมโฮสต์ (Needs host program)**
- **ไม่ขึ้นกับโปรแกรมโฮสต์ (Independent)**

- **ประเภทของโปรแกรมที่เป็นอันตราย:**
  - **Trapdoor**: โปรแกรมที่สร้างทางลัดเพื่อให้เข้าถึงระบบได้โดยไม่ต้องมีสิทธิ์การเข้าถึงปกติ
  - **Logic Bomb**: โปรแกรมที่ทำงานเมื่อเงื่อนไขบางประการถูกกระตุ้น
  - **Trojan Horse**: โปรแกรมที่แฝงตัวอยู่ในรูปแบบของโปรแกรมที่ถูกต้องตามกฎหมาย แต่มีวัตถุประสงค์ที่เป็นอันตราย

### ไวรัส (Viruses)

- **ประเภทของไวรัส:**
  - **File Virus**: ไวรัสที่แนบไปกับไฟล์ .exe และ .com
  - **Boot-sector Virus**: ไวรัสที่ติดตั้งในพื้นที่บูตของดิสก์
  - **Multi-partite Virus**: ไวรัสที่รวมกันระหว่างไฟล์และบูตเซกเตอร์

- **ประเภทของไวรัส:**
  - **Polymorphic Virus**: ไวรัสที่เปลี่ยนรูปแบบการเข้ารหัสเพื่อหลีกเลี่ยงการตรวจจับ
  - **Stealth Virus**: ไวรัสที่หลีกเลี่ยงการตรวจจับโดยซ่อนตัวเอง

- **Bacteria**: ไวรัสที่กระจายได้อย่างรวดเร็ว
- **Worm**: โปรแกรมที่แพร่กระจายได้โดยไม่ต้องการการกระทำของผู้ใช้

### การแพร่กระจายของไวรัสคอมพิวเตอร์
![alt text](/Lecture-3/img/virus.png)
- **แหล่งข้อมูล:** [IBM Research](http://www.research.ibm.com/antivirus/index.htm)

### ตัวอย่าง: Code-Red

- **ประวัติ:**
  - Morris Worm เป็นเวิร์มตัวแรกที่รู้จักในปี 1988
  - ในเดือนมิถุนายน 2001 พบว่าเซิร์ฟเวอร์เว็บ Microsoft IIS มีข้อบกพร่องในบัฟเฟอร์
  - ออกแพตช์อย่างรวดเร็ว แต่ไม่ได้ใช้แพตช์ในทุกที่
  - Code-Red (I) v1 ใช้ช่องโหว่นี้ในเดือนกรกฎาคม 2001
  - Code-Red (I) v2 เริ่มต้นขึ้นในสัปดาห์ถัดมา
  - Code-Red (II) ถูกปล่อยในเดือนสิงหาคม 2001

- **พอร์ต TCP ที่เวิร์มเหล่านี้ตรวจสอบคืออะไร?**

### ความแตกต่างระหว่างเวอร์ชัน

- **Code-Red (I) v1**:
  - พักอยู่ในหน่วยความจำ
  - การรีบูตจะทำให้มันหายไป
  - แต่ละเครื่องที่ติดไวรัสจะสแกนที่อยู่ IP ตามลำดับเดียวกัน

- **Code-Red (I) v2**:
  - ก็พักอยู่ในหน่วยความจำเช่นกัน
  - สแกนที่อยู่ IP โดยใช้ค่าที่สุ่ม
  - มีเครื่องที่ติดไวรัสมากกว่าที่เคย

- **Code-Red (II)**:
  - ไม่มีความเกี่ยวข้อง แต่มีสตริง Code-RedII
  - ไม่พักอยู่ในหน่วยความจำ
  - กลายเป็นนิ่งเป็นเวลาหนึ่งวัน
  - จากนั้นเริ่มแพร่กระจาย

### สรุปการโจมตี Code-Red

- **ฉลาด:** 
  - ไม่ได้สแกนที่อยู่ loopback หรือ multicast

- **การแพร่กระจายแบบ Exponential:**
  - จำนวนโฮสต์ที่ติดไวรัสเติบโตอย่างทวีคูณ
  - ขีดต่ำสุด - 359,000 ที่อยู่ IP ที่ไม่ซ้ำกันสำหรับ Code-Red (I)

- **ประเทศที่ได้รับผลกระทบ:**
  - สหรัฐอเมริกา (43%)
  - เกาหลี (11%)

- **โดเมนที่ได้รับผลกระทบ:**
  - โดเมนหลากหลาย - .net, .edu, .com

### โปรแกรมที่ไม่พึงประสงค์อื่น ๆ

- **Spyware:**
  - ซอฟต์แวร์ที่โฆษณา, เก็บข้อมูลส่วนตัว, หรือเปลี่ยนการตั้งค่าของคอมพิวเตอร์
  - โดยปกติจะทำเช่นนี้โดยไม่ได้รับความยินยอมจากผู้ใช้

- **Researchware?**
  - โปรแกรมที่ใช้ในการวิจัยที่อาจมีการตั้งค่าให้ตรวจสอบหรือเก็บข้อมูล

- **Ransomware:**
  - ซอฟต์แวร์ที่เรียกร้องค่าไถ่เพื่อปลดล็อคข้อมูลหรือระบบ

<br>

# Morals of the Story
**WHAT DO THESE ATTACKS TELL US?**
## การประเมินเครือข่าย (Assess Your Network)

### การกำหนดนโยบายที่เหมาะสม

- มีนโยบายที่เหมาะสมในการจัดการระบบ
- ตรวจสอบให้แน่ใจว่าระบบทำงานเฉพาะบริการที่ได้รับอนุญาต
- ตรวจสอบให้แน่ใจว่ามีช่องโหว่น้อยในเครื่องมือซอฟต์แวร์ที่ใช้งาน
- หลีกเลี่ยงการใช้ Monoculture (การใช้เทคโนโลยีเดียวกันในทุกระบบ)

## การประเมิน (Assessment)

### การกรองแพ็กเก็ต (Filter Packets)

- หากแพ็กเก็ตที่เป็นอันตรายไม่ถึงโฮสต์ จะไม่สามารถก่อให้เกิดความเสียหายได้
- **ไฟร์วอลล์โฮสต์ (Host Firewalls):**
  - ปฏิเสธแพ็กเก็ต ICMP ที่เป็นการกระจายที่มุ่งตรง
  - หากแพ็กเก็ต IP มาจากภายนอกและที่อยู่แหล่งมาจากภายในเครือข่ายของคุณ ให้ปฏิเสธมัน
  - จำกัดการเข้าถึงเครื่องในเครือข่ายของคุณให้มากที่สุดเท่าที่จะเป็นไปได้
  - ปฏิเสธโปรโตคอลที่ไม่รู้จัก

- **ใช้หลักการ:**
  - อย่าให้บุคคลหรือโปรแกรมเข้าถึงหรือสิทธิ์ที่ไม่จำเป็น

## การป้องกัน (Protection)

### การเข้ารหัส (Encryption)

- การใช้โปรโตคอลการเข้ารหัสดีกว่าการไม่ใช้
  - คำนึงถึงประสิทธิภาพ
  - การเข้ารหัสจะปลอดภัยเท่ากับโฮสต์ที่มันเกิดขึ้นจาก
  - การเข้ารหัสจะปลอดภัยเท่ากับรหัสผ่านที่ใช้ในการสร้าง, เก็บ หรือเข้าถึงคีย์
  - ระวังการล้มเหลวของโปรโตคอล

### การตรวจสอบและบันทึกการสื่อสาร (Monitor and Log Communications)

- ติดตามแพ็กเก็ตทั้งหมดที่เข้ามาและออกจากเครือข่าย
  - คุณอาจตรวจจับความผิดปกติ
  - คุณอาจติดตาม Oscar
  - คุณอาจสามารถป้องกันการโจมตีที่ใหญ่กว่าได้
- ใช้ระบบตรวจจับการบุกรุกและกระบวนการตรวจสอบ
  - (บางคนอาจมองว่ามันเป็นการละเมิดความเป็นส่วนตัว)
